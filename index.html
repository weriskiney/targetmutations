<!DOCTYPE html>
<html>
<head>
	<title>Gene Selection Page</title>
	<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
	
	<style>
	
		#table-textarea {
		width: 100%;
		height: 100%;
		font-size: calc(1em * (var(--textarea-min-font-size) + (var(--textarea-max-font-size) - var(--textarea-min-font-size)) * ((100vw - var(--textarea-min-width)) / (var(--textarea-max-width) - var(--textarea-min-width)))));
		}
		:root {
		  --textarea-min-width: 300px;
		  --textarea-max-width: 600px;
		  --textarea-min-font-size: 0.8;
		  --textarea-max-font-size: 1.5;
		}

	</style>
	
</head>
<body>
	<h1>Choose a Gene</h1>
	<form method="POST" enctype="multipart/form-data">
		<label for="gene">Select a gene:</label>
		<select name="gene" id="gene" onchange="chooseGene(event)" required>
			<option value="undefinedGene">-</option>
			<option value="whole_genome">whole_genome</option>
			<option value="nsp1">nsp1</option>
			<option value="ORF1ab">ORF1ab</option>
			<option value="nsp2">nsp2</option>
			<option value="nsp3">nsp3</option>
			<option value="nsp4">nsp4</option>
			<option value="threeCLikeProteinase">threeCLikeProteinase</option>
			<option value="nsp6">nsp6</option>
			<option value="nsp7">nsp7</option>
			<option value="nsp8">nsp8</option>
			<option value="nsp9">nsp9</option>
			<option value="nsp10">nsp10</option>
			<option value="RNAdependentRNAPolymerase">RNAdependentRNAPolymerase</option>
			<option value="helicase">helicase</option>
			<option value="threeToFiveExonuclease">threeToFiveExonuclease</option>
			<option value="endoRNAse">endoRNAse</option>
			<option value="twoORiboseMethyltransferase">twoORiboseMethyltransferase</option>
			<option value="surfaceGlycoprotein">surfaceGlycoprotein</option>
			<option value="ORF3aProtein">ORF3aProtein</option>
			<option value="envelopeProtein">envelopeProtein</option>
			<option value="membraneGlycoprotein">membraneGlycoprotein</option>
			<option value="ORF6Protein">ORF6Protein</option>
			<option value="ORF7aProtein">ORF7aProtein</option>
			<option value="ORF7b">ORF7b</option>
			<option value="ORF8Protein">ORF8Protein</option>
			<option value="nucleocapsidPhosphoprotein">nucleocapsidPhosphoprotein</option>
			<option value="ORF10Protein">ORF10Protein</option>
		</select>
		<br><br>
		<label for="forward">Forward Primer:</label>
		<input type="text" id="forward" name="forward" ><br><br>
		<label for="probe">Probe Primer (optional):</label>
		<input type="text" id="probe" name="probe"><br><br>
		<label for="reverse">Reverse Primer:</label>
		<input type="text" id="reverse" name="reverse" ><br><br>
		<!--
		<label for="upload">Upload Mutation Data:</label>
		<input type="file" id="upload" name="upload" accept="text/csv" onchange="readFile(event)" required><br><br>
		-->
		<input type="submit" value="Submit" onclick="main(event)">
	</form>
	
<div id="textbox"></div>
	
	<script>
		
		const reference = "ATTAAAGGTTTATACCTTCCCAGGTAACAAACCAACCAACTTTCGATCTCTTGTAGATCTGTTCTCTAAACGAACTTTAAAATCTGTGTGGCTGTCACTCGGCTGCATGCTTAGTGCACTCACGCAGTATAATTAATAACTAATTACTGTCGTTGACAGGACACGAGTAACTCGTCTATCTTCTGCAGGCTGCTTACGGTTTCGTCCGTGTTGCAGCCGATCATCAGCACATCTAGGTTTCGTCCGGGTGTGACCGAAAGGTAAGATGGAGAGCCTTGTCCCTGGTTTCAACGAGAAAACACACGTCCAACTCAGTTTGCCTGTTTTACAGGTTCGCGACGTGCTCGTACGTGGCTTTGGAGACTCCGTGGAGGAGGTCTTATCAGAGGCACGTCAACATCTTAAAGATGGCACTTGTGGCTTAGTAGAAGTTGAAAAAGGCGTTTTGCCTCAACTTGAACAGCCCTATGTGTTCATCAAACGTTCGGATGCTCGAACTGCACCTCATGGTCATGTTATGGTTGAGCTGGTAGCAGAACTCGAAGGCATTCAGTACGGTCGTAGTGGTGAGACACTTGGTGTCCTTGTCCCTCATGTGGGCGAAATACCAGTGGCTTACCGCAAGGTTCTTCTTCGTAAGAACGGTAATAAAGGAGCTGGTGGCCATAGTTACGGCGCCGATCTAAAGTCATTTGACTTAGGCGACGAGCTTGGCACTGATCCTTATGAAGATTTTCAAGAAAACTGGAACACTAAACATAGCAGTGGTGTTACCCGTGAACTCATGCGTGAGCTTAACGGAGGGGCATACACTCGCTATGTCGATAACAACTTCTGTGGCCCTGATGGCTACCCTCTTGAGTGCATTAAAGACCTTCTAGCACGTGCTGGTAAAGCTTCATGCACTTTGTCCGAACAACTGGACTTTATTGACACTAAGAGGGGTGTATACTGCTGCCGTGAACATGAGCATGAAATTGCTTGGTACACGGAACGTTCTGAAAAGAGCTATGAATTGCAGACACCTTTTGAAATTAAATTGGCAAAGAAATTTGACACCTTCAATGGGGAATGTCCAAATTTTGTATTTCCCTTAAATTCCATAATCAAGACTATTCAACCAAGGGTTGAAAAGAAAAAGCTTGATGGCTTTATGGGTAGAATTCGATCTGTCTATCCAGTTGCGTCACCAAATGAATGCAACCAAATGTGCCTTTCAACTCTCATGAAGTGTGATCATTGTGGTGAAACTTCATGGCAGACGGGCGATTTTGTTAAAGCCACTTGCGAATTTTGTGGCACTGAGAATTTGACTAAAGAAGGTGCCACTACTTGTGGTTACTTACCCCAAAATGCTGTTGTTAAAATTTATTGTCCAGCATGTCACAATTCAGAAGTAGGACCTGAGCATAGTCTTGCCGAATACCATAATGAATCTGGCTTGAAAACCATTCTTCGTAAGGGTGGTCGCACTATTGCCTTTGGAGGCTGTGTGTTCTCTTATGTTGGTTGCCATAACAAGTGTGCCTATTGGGTTCCACGTGCTAGCGCTAACATAGGTTGTAACCATACAGGTGTTGTTGGAGAAGGTTCCGAAGGTCTTAATGACAACCTTCTTGAAATACTCCAAAAAGAGAAAGTCAACATCAATATTGTTGGTGACTTTAAACTTAATGAAGAGATCGCCATTATTTTGGCATCTTTTTCTGCTTCCACAAGTGCTTTTGTGGAAACTGTGAAAGGTTTGGATTATAAAGCATTCAAACAAATTGTTGAATCCTGTGGTAATTTTAAAGTTACAAAAGGAAAAGCTAAAAAAGGTGCCTGGAATATTGGTGAACAGAAATCAATACTGAGTCCTCTTTATGCATTTGCATCAGAGGCTGCTCGTGTTGTACGATCAATTTTCTCCCGCACTCTTGAAACTGCTCAAAATTCTGTGCGTGTTTTACAGAAGGCCGCTATAACAATACTAGATGGAATTTCACAGTATTCACTGAGACTCATTGATGCTATGATGTTCACATCTGATTTGGCTACTAACAATCTAGTTGTAATGGCCTACATTACAGGTGGTGTTGTTCAGTTGACTTCGCAGTGGCTAACTAACATCTTTGGCACTGTTTATGAAAAACTCAAACCCGTCCTTGATTGGCTTGAAGAGAAGTTTAAGGAAGGTGTAGAGTTTCTTAGAGACGGTTGGGAAATTGTTAAATTTATCTCAACCTGTGCTTGTGAAATTGTCGGTGGACAAATTGTCACCTGTGCAAAGGAAATTAAGGAGAGTGTTCAGACATTCTTTAAGCTTGTAAATAAATTTTTGGCTTTGTGTGCTGACTCTATCATTATTGGTGGAGCTAAACTTAAAGCCTTGAATTTAGGTGAAACATTTGTCACGCACTCAAAGGGATTGTACAGAAAGTGTGTTAAATCCAGAGAAGAAACTGGCCTACTCATGCCTCTAAAAGCCCCAAAAGAAATTATCTTCTTAGAGGGAGAAACACTTCCCACAGAAGTGTTAACAGAGGAAGTTGTCTTGAAAACTGGTGATTTACAACCATTAGAACAACCTACTAGTGAAGCTGTTGAAGCTCCATTGGTTGGTACACCAGTTTGTATTAACGGGCTTATGTTGCTCGAAATCAAAGACACAGAAAAGTACTGTGCCCTTGCACCTAATATGATGGTAACAAACAATACCTTCACACTCAAAGGCGGTGCACCAACAAAGGTTACTTTTGGTGATGACACTGTGATAGAAGTGCAAGGTTACAAGAGTGTGAATATCACTTTTGAACTTGATGAAAGGATTGATAAAGTACTTAATGAGAAGTGCTCTGCCTATACAGTTGAACTCGGTACAGAAGTAAATGAGTTCGCCTGTGTTGTGGCAGATGCTGTCATAAAAACTTTGCAACCAGTATCTGAATTACTTACACCACTGGGCATTGATTTAGATGAGTGGAGTATGGCTACATACTACTTATTTGATGAGTCTGGTGAGTTTAAATTGGCTTCACATATGTATTGTTCTTTCTACCCTCCAGATGAGGATGAAGAAGAAGGTGATTGTGAAGAAGAAGAGTTTGAGCCATCAACTCAATATGAGTATGGTACTGAAGATGATTACCAAGGTAAACCTTTGGAATTTGGTGCCACTTCTGCTGCTCTTCAACCTGAAGAAGAGCAAGAAGAAGATTGGTTAGATGATGATAGTCAACAAACTGTTGGTCAACAAGACGGCAGTGAGGACAATCAGACAACTACTATTCAAACAATTGTTGAGGTTCAACCTCAATTAGAGATGGAACTTACACCAGTTGTTCAGACTATTGAAGTGAATAGTTTTAGTGGTTATTTAAAACTTACTGACAATGTATACATTAAAAATGCAGACATTGTGGAAGAAGCTAAAAAGGTAAAACCAACAGTGGTTGTTAATGCAGCCAATGTTTACCTTAAACATGGAGGAGGTGTTGCAGGAGCCTTAAATAAGGCTACTAACAATGCCATGCAAGTTGAATCTGATGATTACATAGCTACTAATGGACCACTTAAAGTGGGTGGTAGTTGTGTTTTAAGCGGACACAATCTTGCTAAACACTGTCTTCATGTTGTCGGCCCAAATGTTAACAAAGGTGAAGACATTCAACTTCTTAAGAGTGCTTATGAAAATTTTAATCAGCACGAAGTTCTACTTGCACCATTATTATCAGCTGGTATTTTTGGTGCTGACCCTATACATTCTTTAAGAGTTTGTGTAGATACTGTTCGCACAAATGTCTACTTAGCTGTCTTTGATAAAAATCTCTATGACAAACTTGTTTCAAGCTTTTTGGAAATGAAGAGTGAAAAGCAAGTTGAACAAAAGATCGCTGAGATTCCTAAAGAGGAAGTTAAGCCATTTATAACTGAAAGTAAACCTTCAGTTGAACAGAGAAAACAAGATGATAAGAAAATCAAAGCTTGTGTTGAAGAAGTTACAACAACTCTGGAAGAAACTAAGTTCCTCACAGAAAACTTGTTACTTTATATTGACATTAATGGCAATCTTCATCCAGATTCTGCCACTCTTGTTAGTGACATTGACATCACTTTCTTAAAGAAAGATGCTCCATATATAGTGGGTGATGTTGTTCAAGAGGGTGTTTTAACTGCTGTGGTTATACCTACTAAAAAGGCTGGTGGCACTACTGAAATGCTAGCGAAAGCTTTGAGAAAAGTGCCAACAGACAATTATATAACCACTTACCCGGGTCAGGGTTTAAATGGTTACACTGTAGAGGAGGCAAAGACAGTGCTTAAAAAGTGTAAAAGTGCCTTTTACATTCTACCATCTATTATCTCTAATGAGAAGCAAGAAATTCTTGGAACTGTTTCTTGGAATTTGCGAGAAATGCTTGCACATGCAGAAGAAACACGCAAATTAATGCCTGTCTGTGTGGAAACTAAAGCCATAGTTTCAACTATACAGCGTAAATATAAGGGTATTAAAATACAAGAGGGTGTGGTTGATTATGGTGCTAGATTTTACTTTTACACCAGTAAAACAACTGTAGCGTCACTTATCAACACACTTAACGATCTAAATGAAACTCTTGTTACAATGCCACTTGGCTATGTAACACATGGCTTAAATTTGGAAGAAGCTGCTCGGTATATGAGATCTCTCAAAGTGCCAGCTACAGTTTCTGTTTCTTCACCTGATGCTGTTACAGCGTATAATGGTTATCTTACTTCTTCTTCTAAAACACCTGAAGAACATTTTATTGAAACCATCTCACTTGCTGGTTCCTATAAAGATTGGTCCTATTCTGGACAATCTACACAACTAGGTATAGAATTTCTTAAGAGAGGTGATAAAAGTGTATATTACACTAGTAATCCTACCACATTCCACCTAGATGGTGAAGTTATCACCTTTGACAATCTTAAGACACTTCTTTCTTTGAGAGAAGTGAGGACTATTAAGGTGTTTACAACAGTAGACAACATTAACCTCCACACGCAAGTTGTGGACATGTCAATGACATATGGACAACAGTTTGGTCCAACTTATTTGGATGGAGCTGATGTTACTAAAATAAAACCTCATAATTCACATGAAGGTAAAACATTTTATGTTTTACCTAATGATGACACTCTACGTGTTGAGGCTTTTGAGTACTACCACACAACTGATCCTAGTTTTCTGGGTAGGTACATGTCAGCATTAAATCACACTAAAAAGTGGAAATACCCACAAGTTAATGGTTTAACTTCTATTAAATGGGCAGATAACAACTGTTATCTTGCCACTGCATTGTTAACACTCCAACAAATAGAGTTGAAGTTTAATCCACCTGCTCTACAAGATGCTTATTACAGAGCAAGGGCTGGTGAAGCTGCTAACTTTTGTGCACTTATCTTAGCCTACTGTAATAAGACAGTAGGTGAGTTAGGTGATGTTAGAGAAACAATGAGTTACTTGTTTCAACATGCCAATTTAGATTCTTGCAAAAGAGTCTTGAACGTGGTGTGTAAAACTTGTGGACAACAGCAGACAACCCTTAAGGGTGTAGAAGCTGTTATGTACATGGGCACACTTTCTTATGAACAATTTAAGAAAGGTGTTCAGATACCTTGTACGTGTGGTAAACAAGCTACAAAATATCTAGTACAACAGGAGTCACCTTTTGTTATGATGTCAGCACCACCTGCTCAGTATGAACTTAAGCATGGTACATTTACTTGTGCTAGTGAGTACACTGGTAATTACCAGTGTGGTCACTATAAACATATAACTTCTAAAGAAACTTTGTATTGCATAGACGGTGCTTTACTTACAAAGTCCTCAGAATACAAAGGTCCTATTACGGATGTTTTCTACAAAGAAAACAGTTACACAACAACCATAAAACCAGTTACTTATAAATTGGATGGTGTTGTTTGTACAGAAATTGACCCTAAGTTGGACAATTATTATAAGAAAGACAATTCTTATTTCACAGAGCAACCAATTGATCTTGTACCAAACCAACCATATCCAAACGCAAGCTTCGATAATTTTAAGTTTGTATGTGATAATATCAAATTTGCTGATGATTTAAACCAGTTAACTGGTTATAAGAAACCTGCTTCAAGAGAGCTTAAAGTTACATTTTTCCCTGACTTAAATGGTGATGTGGTGGCTATTGATTATAAACACTACACACCCTCTTTTAAGAAAGGAGCTAAATTGTTACATAAACCTATTGTTTGGCATGTTAACAATGCAACTAATAAAGCCACGTATAAACCAAATACCTGGTGTATACGTTGTCTTTGGAGCACAAAACCAGTTGAAACATCAAATTCGTTTGATGTACTGAAGTCAGAGGACGCGCAGGGAATGGATAATCTTGCCTGCGAAGATCTAAAACCAGTCTCTGAAGAAGTAGTGGAAAATCCTACCATACAGAAAGACGTTCTTGAGTGTAATGTGAAAACTACCGAAGTTGTAGGAGACATTATACTTAAACCAGCAAATAATAGTTTAAAAATTACAGAAGAGGTTGGCCACACAGATCTAATGGCTGCTTATGTAGACAATTCTAGTCTTACTATTAAGAAACCTAATGAATTATCTAGAGTATTAGGTTTGAAAACCCTTGCTACTCATGGTTTAGCTGCTGTTAATAGTGTCCCTTGGGATACTATAGCTAATTATGCTAAGCCTTTTCTTAACAAAGTTGTTAGTACAACTACTAACATAGTTACACGGTGTTTAAACCGTGTTTGTACTAATTATATGCCTTATTTCTTTACTTTATTGCTACAATTGTGTACTTTTACTAGAAGTACAAATTCTAGAATTAAAGCATCTATGCCGACTACTATAGCAAAGAATACTGTTAAGAGTGTCGGTAAATTTTGTCTAGAGGCTTCATTTAATTATTTGAAGTCACCTAATTTTTCTAAACTGATAAATATTATAATTTGGTTTTTACTATTAAGTGTTTGCCTAGGTTCTTTAATCTACTCAACCGCTGCTTTAGGTGTTTTAATGTCTAATTTAGGCATGCCTTCTTACTGTACTGGTTACAGAGAAGGCTATTTGAACTCTACTAATGTCACTATTGCAACCTACTGTACTGGTTCTATACCTTGTAGTGTTTGTCTTAGTGGTTTAGATTCTTTAGACACCTATCCTTCTTTAGAAACTATACAAATTACCATTTCATCTTTTAAATGGGATTTAACTGCTTTTGGCTTAGTTGCAGAGTGGTTTTTGGCATATATTCTTTTCACTAGGTTTTTCTATGTACTTGGATTGGCTGCAATCATGCAATTGTTTTTCAGCTATTTTGCAGTACATTTTATTAGTAATTCTTGGCTTATGTGGTTAATAATTAATCTTGTACAAATGGCCCCGATTTCAGCTATGGTTAGAATGTACATCTTCTTTGCATCATTTTATTATGTATGGAAAAGTTATGTGCATGTTGTAGACGGTTGTAATTCATCAACTTGTATGATGTGTTACAAACGTAATAGAGCAACAAGAGTCGAATGTACAACTATTGTTAATGGTGTTAGAAGGTCCTTTTATGTCTATGCTAATGGAGGTAAAGGCTTTTGCAAACTACACAATTGGAATTGTGTTAATTGTGATACATTCTGTGCTGGTAGTACATTTATTAGTGATGAAGTTGCGAGAGACTTGTCACTACAGTTTAAAAGACCAATAAATCCTACTGACCAGTCTTCTTACATCGTTGATAGTGTTACAGTGAAGAATGGTTCCATCCATCTTTACTTTGATAAAGCTGGTCAAAAGACTTATGAAAGACATTCTCTCTCTCATTTTGTTAACTTAGACAACCTGAGAGCTAATAACACTAAAGGTTCATTGCCTATTAATGTTATAGTTTTTGATGGTAAATCAAAATGTGAAGAATCATCTGCAAAATCAGCGTCTGTTTACTACAGTCAGCTTATGTGTCAACCTATACTGTTACTAGATCAGGCATTAGTGTCTGATGTTGGTGATAGTGCGGAAGTTGCAGTTAAAATGTTTGATGCTTACGTTAATACGTTTTCATCAACTTTTAACGTACCAATGGAAAAACTCAAAACACTAGTTGCAACTGCAGAAGCTGAACTTGCAAAGAATGTGTCCTTAGACAATGTCTTATCTACTTTTATTTCAGCAGCTCGGCAAGGGTTTGTTGATTCAGATGTAGAAACTAAAGATGTTGTTGAATGTCTTAAATTGTCACATCAATCTGACATAGAAGTTACTGGCGATAGTTGTAATAACTATATGCTCACCTATAACAAAGTTGAAAACATGACACCCCGTGACCTTGGTGCTTGTATTGACTGTAGTGCGCGTCATATTAATGCGCAGGTAGCAAAAAGTCACAACATTGCTTTGATATGGAACGTTAAAGATTTCATGTCATTGTCTGAACAACTACGAAAACAAATACGTAGTGCTGCTAAAAAGAATAACTTACCTTTTAAGTTGACATGTGCAACTACTAGACAAGTTGTTAATGTTGTAACAACAAAGATAGCACTTAAGGGTGGTAAAATTGTTAATAATTGGTTGAAGCAGTTAATTAAAGTTACACTTGTGTTCCTTTTTGTTGCTGCTATTTTCTATTTAATAACACCTGTTCATGTCATGTCTAAACATACTGACTTTTCAAGTGAAATCATAGGATACAAGGCTATTGATGGTGGTGTCACTCGTGACATAGCATCTACAGATACTTGTTTTGCTAACAAACATGCTGATTTTGACACATGGTTTAGCCAGCGTGGTGGTAGTTATACTAATGACAAAGCTTGCCCATTGATTGCTGCAGTCATAACAAGAGAAGTGGGTTTTGTCGTGCCTGGTTTGCCTGGCACGATATTACGCACAACTAATGGTGACTTTTTGCATTTCTTACCTAGAGTTTTTAGTGCAGTTGGTAACATCTGTTACACACCATCAAAACTTATAGAGTACACTGACTTTGCAACATCAGCTTGTGTTTTGGCTGCTGAATGTACAATTTTTAAAGATGCTTCTGGTAAGCCAGTACCATATTGTTATGATACCAATGTACTAGAAGGTTCTGTTGCTTATGAAAGTTTACGCCCTGACACACGTTATGTGCTCATGGATGGCTCTATTATTCAATTTCCTAACACCTACCTTGAAGGTTCTGTTAGAGTGGTAACAACTTTTGATTCTGAGTACTGTAGGCACGGCACTTGTGAAAGATCAGAAGCTGGTGTTTGTGTATCTACTAGTGGTAGATGGGTACTTAACAATGATTATTACAGATCTTTACCAGGAGTTTTCTGTGGTGTAGATGCTGTAAATTTACTTACTAATATGTTTACACCACTAATTCAACCTATTGGTGCTTTGGACATATCAGCATCTATAGTAGCTGGTGGTATTGTAGCTATCGTAGTAACATGCCTTGCCTACTATTTTATGAGGTTTAGAAGAGCTTTTGGTGAATACAGTCATGTAGTTGCCTTTAATACTTTACTATTCCTTATGTCATTCACTGTACTCTGTTTAACACCAGTTTACTCATTCTTACCTGGTGTTTATTCTGTTATTTACTTGTACTTGACATTTTATCTTACTAATGATGTTTCTTTTTTAGCACATATTCAGTGGATGGTTATGTTCACACCTTTAGTACCTTTCTGGATAACAATTGCTTATATCATTTGTATTTCCACAAAGCATTTCTATTGGTTCTTTAGTAATTACCTAAAGAGACGTGTAGTCTTTAATGGTGTTTCCTTTAGTACTTTTGAAGAAGCTGCGCTGTGCACCTTTTTGTTAAATAAAGAAATGTATCTAAAGTTGCGTAGTGATGTGCTATTACCTCTTACGCAATATAATAGATACTTAGCTCTTTATAATAAGTACAAGTATTTTAGTGGAGCAATGGATACAACTAGCTACAGAGAAGCTGCTTGTTGTCATCTCGCAAAGGCTCTCAATGACTTCAGTAACTCAGGTTCTGATGTTCTTTACCAACCACCACAAACCTCTATCACCTCAGCTGTTTTGCAGAGTGGTTTTAGAAAAATGGCATTCCCATCTGGTAAAGTTGAGGGTTGTATGGTACAAGTAACTTGTGGTACAACTACACTTAACGGTCTTTGGCTTGATGACGTAGTTTACTGTCCAAGACATGTGATCTGCACCTCTGAAGACATGCTTAACCCTAATTATGAAGATTTACTCATTCGTAAGTCTAATCATAATTTCTTGGTACAGGCTGGTAATGTTCAACTCAGGGTTATTGGACATTCTATGCAAAATTGTGTACTTAAGCTTAAGGTTGATACAGCCAATCCTAAGACACCTAAGTATAAGTTTGTTCGCATTCAACCAGGACAGACTTTTTCAGTGTTAGCTTGTTACAATGGTTCACCATCTGGTGTTTACCAATGTGCTATGAGGCCCAATTTCACTATTAAGGGTTCATTCCTTAATGGTTCATGTGGTAGTGTTGGTTTTAACATAGATTATGACTGTGTCTCTTTTTGTTACATGCACCATATGGAATTACCAACTGGAGTTCATGCTGGCACAGACTTAGAAGGTAACTTTTATGGACCTTTTGTTGACAGGCAAACAGCACAAGCAGCTGGTACGGACACAACTATTACAGTTAATGTTTTAGCTTGGTTGTACGCTGCTGTTATAAATGGAGACAGGTGGTTTCTCAATCGATTTACCACAACTCTTAATGACTTTAACCTTGTGGCTATGAAGTACAATTATGAACCTCTAACACAAGACCATGTTGACATACTAGGACCTCTTTCTGCTCAAACTGGAATTGCCGTTTTAGATATGTGTGCTTCATTAAAAGAATTACTGCAAAATGGTATGAATGGACGTACCATATTGGGTAGTGCTTTATTAGAAGATGAATTTACACCTTTTGATGTTGTTAGACAATGCTCAGGTGTTACTTTCCAAAGTGCAGTGAAAAGAACAATCAAGGGTACACACCACTGGTTGTTACTCACAATTTTGACTTCACTTTTAGTTTTAGTCCAGAGTACTCAATGGTCTTTGTTCTTTTTTTTGTATGAAAATGCCTTTTTACCTTTTGCTATGGGTATTATTGCTATGTCTGCTTTTGCAATGATGTTTGTCAAACATAAGCATGCATTTCTCTGTTTGTTTTTGTTACCTTCTCTTGCCACTGTAGCTTATTTTAATATGGTCTATATGCCTGCTAGTTGGGTGATGCGTATTATGACATGGTTGGATATGGTTGATACTAGTTTGTCTGGTTTTAAGCTAAAAGACTGTGTTATGTATGCATCAGCTGTAGTGTTACTAATCCTTATGACAGCAAGAACTGTGTATGATGATGGTGCTAGGAGAGTGTGGACACTTATGAATGTCTTGACACTCGTTTATAAAGTTTATTATGGTAATGCTTTAGATCAAGCCATTTCCATGTGGGCTCTTATAATCTCTGTTACTTCTAACTACTCAGGTGTAGTTACAACTGTCATGTTTTTGGCCAGAGGTATTGTTTTTATGTGTGTTGAGTATTGCCCTATTTTCTTCATAACTGGTAATACACTTCAGTGTATAATGCTAGTTTATTGTTTCTTAGGCTATTTTTGTACTTGTTACTTTGGCCTCTTTTGTTTACTCAACCGCTACTTTAGACTGACTCTTGGTGTTTATGATTACTTAGTTTCTACACAGGAGTTTAGATATATGAATTCACAGGGACTACTCCCACCCAAGAATAGCATAGATGCCTTCAAACTCAACATTAAATTGTTGGGTGTTGGTGGCAAACCTTGTATCAAAGTAGCCACTGTACAGTCTAAAATGTCAGATGTAAAGTGCACATCAGTAGTCTTACTCTCAGTTTTGCAACAACTCAGAGTAGAATCATCATCTAAATTGTGGGCTCAATGTGTCCAGTTACACAATGACATTCTCTTAGCTAAAGATACTACTGAAGCCTTTGAAAAAATGGTTTCACTACTTTCTGTTTTGCTTTCCATGCAGGGTGCTGTAGACATAAACAAGCTTTGTGAAGAAATGCTGGACAACAGGGCAACCTTACAAGCTATAGCCTCAGAGTTTAGTTCCCTTCCATCATATGCAGCTTTTGCTACTGCTCAAGAAGCTTATGAGCAGGCTGTTGCTAATGGTGATTCTGAAGTTGTTCTTAAAAAGTTGAAGAAGTCTTTGAATGTGGCTAAATCTGAATTTGACCGTGATGCAGCCATGCAACGTAAGTTGGAAAAGATGGCTGATCAAGCTATGACCCAAATGTATAAACAGGCTAGATCTGAGGACAAGAGGGCAAAAGTTACTAGTGCTATGCAGACAATGCTTTTCACTATGCTTAGAAAGTTGGATAATGATGCACTCAACAACATTATCAACAATGCAAGAGATGGTTGTGTTCCCTTGAACATAATACCTCTTACAACAGCAGCCAAACTAATGGTTGTCATACCAGACTATAACACATATAAAAATACGTGTGATGGTACAACATTTACTTATGCATCAGCATTGTGGGAAATCCAACAGGTTGTAGATGCAGATAGTAAAATTGTTCAACTTAGTGAAATTAGTATGGACAATTCACCTAATTTAGCATGGCCTCTTATTGTAACAGCTTTAAGGGCCAATTCTGCTGTCAAATTACAGAATAATGAGCTTAGTCCTGTTGCACTACGACAGATGTCTTGTGCTGCCGGTACTACACAAACTGCTTGCACTGATGACAATGCGTTAGCTTACTACAACACAACAAAGGGAGGTAGGTTTGTACTTGCACTGTTATCCGATTTACAGGATTTGAAATGGGCTAGATTCCCTAAGAGTGATGGAACTGGTACTATCTATACAGAACTGGAACCACCTTGTAGGTTTGTTACAGACACACCTAAAGGTCCTAAAGTGAAGTATTTATACTTTATTAAAGGATTAAACAACCTAAATAGAGGTATGGTACTTGGTAGTTTAGCTGCCACAGTACGTCTACAAGCTGGTAATGCAACAGAAGTGCCTGCCAATTCAACTGTATTATCTTTCTGTGCTTTTGCTGTAGATGCTGCTAAAGCTTACAAAGATTATCTAGCTAGTGGGGGACAACCAATCACTAATTGTGTTAAGATGTTGTGTACACACACTGGTACTGGTCAGGCAATAACAGTTACACCGGAAGCCAATATGGATCAAGAATCCTTTGGTGGTGCATCGTGTTGTCTGTACTGCCGTTGCCACATAGATCATCCAAATCCTAAAGGATTTTGTGACTTAAAAGGTAAGTATGTACAAATACCTACAACTTGTGCTAATGACCCTGTGGGTTTTACACTTAAAAACACAGTCTGTACCGTCTGCGGTATGTGGAAAGGTTATGGCTGTAGTTGTGATCAACTCCGCGAACCCATGCTTCAGTCAGCTGATGCACAATCGTTTTTAAACGGGTTTGCGGTGTAAGTGCAGCCCGTCTTACACCGTGCGGCACAGGCACTAGTACTGATGTCGTATACAGGGCTTTTGACATCTACAATGATAAAGTAGCTGGTTTTGCTAAATTCCTAAAAACTAATTGTTGTCGCTTCCAAGAAAAGGACGAAGATGACAATTTAATTGATTCTTACTTTGTAGTTAAGAGACACACTTTCTCTAACTACCAACATGAAGAAACAATTTATAATTTACTTAAGGATTGTCCAGCTGTTGCTAAACATGACTTCTTTAAGTTTAGAATAGACGGTGACATGGTACCACATATATCACGTCAACGTCTTACTAAATACACAATGGCAGACCTCGTCTATGCTTTAAGGCATTTTGATGAAGGTAATTGTGACACATTAAAAGAAATACTTGTCACATACAATTGTTGTGATGATGATTATTTCAATAAAAAGGACTGGTATGATTTTGTAGAAAACCCAGATATATTACGCGTATACGCCAACTTAGGTGAACGTGTACGCCAAGCTTTGTTAAAAACAGTACAATTCTGTGATGCCATGCGAAATGCTGGTATTGTTGGTGTACTGACATTAGATAATCAAGATCTCAATGGTAACTGGTATGATTTCGGTGATTTCATACAAACCACGCCAGGTAGTGGAGTTCCTGTTGTAGATTCTTATTATTCATTGTTAATGCCTATATTAACCTTGACCAGGGCTTTAACTGCAGAGTCACATGTTGACACTGACTTAACAAAGCCTTACATTAAGTGGGATTTGTTAAAATATGACTTCACGGAAGAGAGGTTAAAACTCTTTGACCGTTATTTTAAATATTGGGATCAGACATACCACCCAAATTGTGTTAACTGTTTGGATGACAGATGCATTCTGCATTGTGCAAACTTTAATGTTTTATTCTCTACAGTGTTCCCACCTACAAGTTTTGGACCACTAGTGAGAAAAATATTTGTTGATGGTGTTCCATTTGTAGTTTCAACTGGATACCACTTCAGAGAGCTAGGTGTTGTACATAATCAGGATGTAAACTTACATAGCTCTAGACTTAGTTTTAAGGAATTACTTGTGTATGCTGCTGACCCTGCTATGCACGCTGCTTCTGGTAATCTATTACTAGATAAACGCACTACGTGCTTTTCAGTAGCTGCACTTACTAACAATGTTGCTTTTCAAACTGTCAAACCCGGTAATTTTAACAAAGACTTCTATGACTTTGCTGTGTCTAAGGGTTTCTTTAAGGAAGGAAGTTCTGTTGAATTAAAACACTTCTTCTTTGCTCAGGATGGTAATGCTGCTATCAGCGATTATGACTACTATCGTTATAATCTACCAACAATGTGTGATATCAGACAACTACTATTTGTAGTTGAAGTTGTTGATAAGTACTTTGATTGTTACGATGGTGGCTGTATTAATGCTAACCAAGTCATCGTCAACAACCTAGACAAATCAGCTGGTTTTCCATTTAATAAATGGGGTAAGGCTAGACTTTATTATGATTCAATGAGTTATGAGGATCAAGATGCACTTTTCGCATATACAAAACGTAATGTCATCCCTACTATAACTCAAATGAATCTTAAGTATGCCATTAGTGCAAAGAATAGAGCTCGCACCGTAGCTGGTGTCTCTATCTGTAGTACTATGACCAATAGACAGTTTCATCAAAAATTATTGAAATCAATAGCCGCCACTAGAGGAGCTACTGTAGTAATTGGAACAAGCAAATTCTATGGTGGTTGGCACAACATGTTAAAAACTGTTTATAGTGATGTAGAAAACCCTCACCTTATGGGTTGGGATTATCCTAAATGTGATAGAGCCATGCCTAACATGCTTAGAATTATGGCCTCACTTGTTCTTGCTCGCAAACATACAACGTGTTGTAGCTTGTCACACCGTTTCTATAGATTAGCTAATGAGTGTGCTCAAGTATTGAGTGAAATGGTCATGTGTGGCGGTTCACTATATGTTAAACCAGGTGGAACCTCATCAGGAGATGCCACAACTGCTTATGCTAATAGTGTTTTTAACATTTGTCAAGCTGTCACGGCCAATGTTAATGCACTTTTATCTACTGATGGTAACAAAATTGCCGATAAGTATGTCCGCAATTTACAACACAGACTTTATGAGTGTCTCTATAGAAATAGAGATGTTGACACAGACTTTGTGAATGAGTTTTACGCATATTTGCGTAAACATTTCTCAATGATGATACTCTCTGACGATGCTGTTGTGTGTTTCAATAGCACTTATGCATCTCAAGGTCTAGTGGCTAGCATAAAGAACTTTAAGTCAGTTCTTTATTATCAAAACAATGTTTTTATGTCTGAAGCAAAATGTTGGACTGAGACTGACCTTACTAAAGGACCTCATGAATTTTGCTCTCAACATACAATGCTAGTTAAACAGGGTGATGATTATGTGTACCTTCCTTACCCAGATCCATCAAGAATCCTAGGGGCCGGCTGTTTTGTAGATGATATCGTAAAAACAGATGGTACACTTATGATTGAACGGTTCGTGTCTTTAGCTATAGATGCTTACCCACTTACTAAACATCCTAATCAGGAGTATGCTGATGTCTTTCATTTGTACTTACAATACATAAGAAAGCTACATGATGAGTTAACAGGACACATGTTAGACATGTATTCTGTTATGCTTACTAATGATAACACTTCAAGGTATTGGGAACCTGAGTTTTATGAGGCTATGTACACACCGCATACAGTCTTACAGGCTGTTGGGGCTTGTGTTCTTTGCAATTCACAGACTTCATTAAGATGTGGTGCTTGCATACGTAGACCATTCTTATGTTGTAAATGCTGTTACGACCATGTCATATCAACATCACATAAATTAGTCTTGTCTGTTAATCCGTATGTTTGCAATGCTCCAGGTTGTGATGTCACAGATGTGACTCAACTTTACTTAGGAGGTATGAGCTATTATTGTAAATCACATAAACCACCCATTAGTTTTCCATTGTGTGCTAATGGACAAGTTTTTGGTTTATATAAAAATACATGTGTTGGTAGCGATAATGTTACTGACTTTAATGCAATTGCAACATGTGACTGGACAAATGCTGGTGATTACATTTTAGCTAACACCTGTACTGAAAGACTCAAGCTTTTTGCAGCAGAAACGCTCAAAGCTACTGAGGAGACATTTAAACTGTCTTATGGTATTGCTACTGTACGTGAAGTGCTGTCTGACAGAGAATTACATCTTTCATGGGAAGTTGGTAAACCTAGACCACCACTTAACCGAAATTATGTCTTTACTGGTTATCGTGTAACTAAAAACAGTAAAGTACAAATAGGAGAGTACACCTTTGAAAAAGGTGACTATGGTGATGCTGTTGTTTACCGAGGTACAACAACTTACAAATTAAATGTTGGTGATTATTTTGTGCTGACATCACATACAGTAATGCCATTAAGTGCACCTACACTAGTGCCACAAGAGCACTATGTTAGAATTACTGGCTTATACCCAACACTCAATATCTCAGATGAGTTTTCTAGCAATGTTGCAAATTATCAAAAGGTTGGTATGCAAAAGTATTCTACACTCCAGGGACCACCTGGTACTGGTAAGAGTCATTTTGCTATTGGCCTAGCTCTCTACTACCCTTCTGCTCGCATAGTGTATACAGCTTGCTCTCATGCCGCTGTTGATGCACTATGTGAGAAGGCATTAAAATATTTGCCTATAGATAAATGTAGTAGAATTATACCTGCACGTGCTCGTGTAGAGTGTTTTGATAAATTCAAAGTGAATTCAACATTAGAACAGTATGTCTTTTGTACTGTAAATGCATTGCCTGAGACGACAGCAGATATAGTTGTCTTTGATGAAATTTCAATGGCCACAAATTATGATTTGAGTGTTGTCAATGCCAGATTACGTGCTAAGCACTATGTGTACATTGGCGACCCTGCTCAATTACCTGCACCACGCACATTGCTAACTAAGGGCACACTAGAACCAGAATATTTCAATTCAGTGTGTAGACTTATGAAAACTATAGGTCCAGACATGTTCCTCGGAACTTGTCGGCGTTGTCCTGCTGAAATTGTTGACACTGTGAGTGCTTTGGTTTATGATAATAAGCTTAAAGCACATAAAGACAAATCAGCTCAATGCTTTAAAATGTTTTATAAGGGTGTTATCACGCATGATGTTTCATCTGCAATTAACAGGCCACAAATAGGCGTGGTAAGAGAATTCCTTACACGTAACCCTGCTTGGAGAAAAGCTGTCTTTATTTCACCTTATAATTCACAGAATGCTGTAGCCTCAAAGATTTTGGGACTACCAACTCAAACTGTTGATTCATCACAGGGCTCAGAATATGACTATGTCATATTCACTCAAACCACTGAAACAGCTCACTCTTGTAATGTAAACAGATTTAATGTTGCTATTACCAGAGCAAAAGTAGGCATACTTTGCATAATGTCTGATAGAGACCTTTATGACAAGTTGCAATTTACAAGTCTTGAAATTCCACGTAGGAATGTGGCAACTTTACAAGCTGAAAATGTAACAGGACTCTTTAAAGATTGTAGTAAGGTAATCACTGGGTTACATCCTACACAGGCACCTACACACCTCAGTGTTGACACTAAATTCAAAACTGAAGGTTTATGTGTTGACATACCTGGCATACCTAAGGACATGACCTATAGAAGACTCATCTCTATGATGGGTTTTAAAATGAATTATCAAGTTAATGGTTACCCTAACATGTTTATCACCCGCGAAGAAGCTATAAGACATGTACGTGCATGGATTGGCTTCGATGTCGAGGGGTGTCATGCTACTAGAGAAGCTGTTGGTACCAATTTACCTTTACAGCTAGGTTTTTCTACAGGTGTTAACCTAGTTGCTGTACCTACAGGTTATGTTGATACACCTAATAATACAGATTTTTCCAGAGTTAGTGCTAAACCACCGCCTGGAGATCAATTTAAACACCTCATACCACTTATGTACAAAGGACTTCCTTGGAATGTAGTGCGTATAAAGATTGTACAAATGTTAAGTGACACACTTAAAAATCTCTCTGACAGAGTCGTATTTGTCTTATGGGCACATGGCTTTGAGTTGACATCTATGAAGTATTTTGTGAAAATAGGACCTGAGCGCACCTGTTGTCTATGTGATAGACGTGCCACATGCTTTTCCACTGCTTCAGACACTTATGCCTGTTGGCATCATTCTATTGGATTTGATTACGTCTATAATCCGTTTATGATTGATGTTCAACAATGGGGTTTTACAGGTAACCTACAAAGCAACCATGATCTGTATTGTCAAGTCCATGGTAATGCACATGTAGCTAGTTGTGATGCAATCATGACTAGGTGTCTAGCTGTCCACGAGTGCTTTGTTAAGCGTGTTGACTGGACTATTGAATATCCTATAATTGGTGATGAACTGAAGATTAATGCGGCTTGTAGAAAGGTTCAACACATGGTTGTTAAAGCTGCATTATTAGCAGACAAATTCCCAGTTCTTCACGACATTGGTAACCCTAAAGCTATTAAGTGTGTACCTCAAGCTGATGTAGAATGGAAGTTCTATGATGCACAGCCTTGTAGTGACAAAGCTTATAAAATAGAAGAATTATTCTATTCTTATGCCACACATTCTGACAAATTCACAGATGGTGTATGCCTATTTTGGAATTGCAATGTCGATAGATATCCTGCTAATTCCATTGTTTGTAGATTTGACACTAGAGTGCTATCTAACCTTAACTTGCCTGGTTGTGATGGTGGCAGTTTGTATGTAAATAAACATGCATTCCACACACCAGCTTTTGATAAAAGTGCTTTTGTTAATTTAAAACAATTACCATTTTTCTATTACTCTGACAGTCCATGTGAGTCTCATGGAAAACAAGTAGTGTCAGATATAGATTATGTACCACTAAAGTCTGCTACGTGTATAACACGTTGCAATTTAGGTGGTGCTGTCTGTAGACATCATGCTAATGAGTACAGATTGTATCTCGATGCTTATAACATGATGATCTCAGCTGGCTTTAGCTTGTGGGTTTACAAACAATTTGATACTTATAACCTCTGGAACACTTTTACAAGACTTCAGAGTTTAGAAAATGTGGCTTTTAATGTTGTAAATAAGGGACACTTTGATGGACAACAGGGTGAAGTACCAGTTTCTATCATTAATAACACTGTTTACACAAAAGTTGATGGTGTTGATGTAGAATTGTTTGAAAATAAAACAACATTACCTGTTAATGTAGCATTTGAGCTTTGGGCTAAGCGCAACATTAAACCAGTACCAGAGGTGAAAATACTCAATAATTTGGGTGTGGACATTGCTGCTAATACTGTGATCTGGGACTACAAAAGAGATGCTCCAGCACATATATCTACTATTGGTGTTTGTTCTATGACTGACATAGCCAAGAAACCAACTGAAACGATTTGTGCACCACTCACTGTCTTTTTTGATGGTAGAGTTGATGGTCAAGTAGACTTATTTAGAAATGCCCGTAATGGTGTTCTTATTACAGAAGGTAGTGTTAAAGGTTTACAACCATCTGTAGGTCCCAAACAAGCTAGTCTTAATGGAGTCACATTAATTGGAGAAGCCGTAAAAACACAGTTCAATTATTATAAGAAAGTTGATGGTGTTGTCCAACAATTACCTGAAACTTACTTTACTCAGAGTAGAAATTTACAAGAATTTAAACCCAGGAGTCAAATGGAAATTGATTTCTTAGAATTAGCTATGGATGAATTCATTGAACGGTATAAATTAGAAGGCTATGCCTTCGAACATATCGTTTATGGAGATTTTAGTCATAGTCAGTTAGGTGGTTTACATCTACTGATTGGACTAGCTAAACGTTTTAAGGAATCACCTTTTGAATTAGAAGATTTTATTCCTATGGACAGTACAGTTAAAAACTATTTCATAACAGATGCGCAAACAGGTTCATCTAAGTGTGTGTGTTCTGTTATTGATTTATTACTTGATGATTTTGTTGAAATAATAAAATCCCAAGATTTATCTGTAGTTTCTAAGGTTGTCAAAGTGACTATTGACTATACAGAAATTTCATTTATGCTTTGGTGTAAAGATGGCCATGTAGAAACATTTTACCCAAAATTACAATCTAGTCAAGCGTGGCAACCGGGTGTTGCTATGCCTAATCTTTACAAAATGCAAAGAATGCTATTAGAAAAGTGTGACCTTCAAAATTATGGTGATAGTGCAACATTACCTAAAGGCATAATGATGAATGTCGCAAAATATACTCAACTGTGTCAATATTTAAACACATTAACATTAGCTGTACCCTATAATATGAGAGTTATACATTTTGGTGCTGGTTCTGATAAAGGAGTTGCACCAGGTACAGCTGTTTTAAGACAGTGGTTGCCTACGGGTACGCTGCTTGTCGATTCAGATCTTAATGACTTTGTCTCTGATGCAGATTCAACTTTGATTGGTGATTGTGCAACTGTACATACAGCTAATAAATGGGATCTCATTATTAGTGATATGTACGACCCTAAGACTAAAAATGTTACAAAAGAAAATGACTCTAAAGAGGGTTTTTTCACTTACATTTGTGGGTTTATACAACAAAAGCTAGCTCTTGGAGGTTCCGTGGCTATAAAGATAACAGAACATTCTTGGAATGCTGATCTTTATAAGCTCATGGGACACTTCGCATGGTGGACAGCCTTTGTTACTAATGTGAATGCGTCATCATCTGAAGCATTTTTAATTGGATGTAATTATCTTGGCAAACCACGCGAACAAATAGATGGTTATGTCATGCATGCAAATTACATATTTTGGAGGAATACAAATCCAATTCAGTTGTCTTCCTATTCTTTATTTGACATGAGTAAATTTCCCCTTAAATTAAGGGGTACTGCTGTTATGTCTTTAAAAGAAGGTCAAATCAATGATATGATTTTATCTCTTCTTAGTAAAGGTAGACTTATAATTAGAGAAAACAACAGAGTTGTTATTTCTAGTGATGTTCTTGTTAACAACTAAACGAACAATGTTTGTTTTTCTTGTTTTATTGCCACTAGTCTCTAGTCAGTGTGTTAATCTTACAACCAGAACTCAATTACCCCCTGCATACACTAATTCTTTCACACGTGGTGTTTATTACCCTGACAAAGTTTTCAGATCCTCAGTTTTACATTCAACTCAGGACTTGTTCTTACCTTTCTTTTCCAATGTTACTTGGTTCCATGCTATACATGTCTCTGGGACCAATGGTACTAAGAGGTTTGATAACCCTGTCCTACCATTTAATGATGGTGTTTATTTTGCTTCCACTGAGAAGTCTAACATAATAAGAGGCTGGATTTTTGGTACTACTTTAGATTCGAAGACCCAGTCCCTACTTATTGTTAATAACGCTACTAATGTTGTTATTAAAGTCTGTGAATTTCAATTTTGTAATGATCCATTTTTGGGTGTTTATTACCACAAAAACAACAAAAGTTGGATGGAAAGTGAGTTCAGAGTTTATTCTAGTGCGAATAATTGCACTTTTGAATATGTCTCTCAGCCTTTTCTTATGGACCTTGAAGGAAAACAGGGTAATTTCAAAAATCTTAGGGAATTTGTGTTTAAGAATATTGATGGTTATTTTAAAATATATTCTAAGCACACGCCTATTAATTTAGTGCGTGATCTCCCTCAGGGTTTTTCGGCTTTAGAACCATTGGTAGATTTGCCAATAGGTATTAACATCACTAGGTTTCAAACTTTACTTGCTTTACATAGAAGTTATTTGACTCCTGGTGATTCTTCTTCAGGTTGGACAGCTGGTGCTGCAGCTTATTATGTGGGTTATCTTCAACCTAGGACTTTTCTATTAAAATATAATGAAAATGGAACCATTACAGATGCTGTAGACTGTGCACTTGACCCTCTCTCAGAAACAAAGTGTACGTTGAAATCCTTCACTGTAGAAAAAGGAATCTATCAAACTTCTAACTTTAGAGTCCAACCAACAGAATCTATTGTTAGATTTCCTAATATTACAAACTTGTGCCCTTTTGGTGAAGTTTTTAACGCCACCAGATTTGCATCTGTTTATGCTTGGAACAGGAAGAGAATCAGCAACTGTGTTGCTGATTATTCTGTCCTATATAATTCCGCATCATTTTCCACTTTTAAGTGTTATGGAGTGTCTCCTACTAAATTAAATGATCTCTGCTTTACTAATGTCTATGCAGATTCATTTGTAATTAGAGGTGATGAAGTCAGACAAATCGCTCCAGGGCAAACTGGAAAGATTGCTGATTATAATTATAAATTACCAGATGATTTTACAGGCTGCGTTATAGCTTGGAATTCTAACAATCTTGATTCTAAGGTTGGTGGTAATTATAATTACCTGTATAGATTGTTTAGGAAGTCTAATCTCAAACCTTTTGAGAGAGATATTTCAACTGAAATCTATCAGGCCGGTAGCACACCTTGTAATGGTGTTGAAGGTTTTAATTGTTACTTTCCTTTACAATCATATGGTTTCCAACCCACTAATGGTGTTGGTTACCAACCATACAGAGTAGTAGTACTTTCTTTTGAACTTCTACATGCACCAGCAACTGTTTGTGGACCTAAAAAGTCTACTAATTTGGTTAAAAACAAATGTGTCAATTTCAACTTCAATGGTTTAACAGGCACAGGTGTTCTTACTGAGTCTAACAAAAAGTTTCTGCCTTTCCAACAATTTGGCAGAGACATTGCTGACACTACTGATGCTGTCCGTGATCCACAGACACTTGAGATTCTTGACATTACACCATGTTCTTTTGGTGGTGTCAGTGTTATAACACCAGGAACAAATACTTCTAACCAGGTTGCTGTTCTTTATCAGGATGTTAACTGCACAGAAGTCCCTGTTGCTATTCATGCAGATCAACTTACTCCTACTTGGCGTGTTTATTCTACAGGTTCTAATGTTTTTCAAACACGTGCAGGCTGTTTAATAGGGGCTGAACATGTCAACAACTCATATGAGTGTGACATACCCATTGGTGCAGGTATATGCGCTAGTTATCAGACTCAGACTAATTCTCCTCGGCGGGCACGTAGTGTAGCTAGTCAATCCATCATTGCCTACACTATGTCACTTGGTGCAGAAAATTCAGTTGCTTACTCTAATAACTCTATTGCCATACCCACAAATTTTACTATTAGTGTTACCACAGAAATTCTACCAGTGTCTATGACCAAGACATCAGTAGATTGTACAATGTACATTTGTGGTGATTCAACTGAATGCAGCAATCTTTTGTTGCAATATGGCAGTTTTTGTACACAATTAAACCGTGCTTTAACTGGAATAGCTGTTGAACAAGACAAAAACACCCAAGAAGTTTTTGCACAAGTCAAACAAATTTACAAAACACCACCAATTAAAGATTTTGGTGGTTTTAATTTTTCACAAATATTACCAGATCCATCAAAACCAAGCAAGAGGTCATTTATTGAAGATCTACTTTTCAACAAAGTGACACTTGCAGATGCTGGCTTCATCAAACAATATGGTGATTGCCTTGGTGATATTGCTGCTAGAGACCTCATTTGTGCACAAAAGTTTAACGGCCTTACTGTTTTGCCACCTTTGCTCACAGATGAAATGATTGCTCAATACACTTCTGCACTGTTAGCGGGTACAATCACTTCTGGTTGGACCTTTGGTGCAGGTGCTGCATTACAAATACCATTTGCTATGCAAATGGCTTATAGGTTTAATGGTATTGGAGTTACACAGAATGTTCTCTATGAGAACCAAAAATTGATTGCCAACCAATTTAATAGTGCTATTGGCAAAATTCAAGACTCACTTTCTTCCACAGCAAGTGCACTTGGAAAACTTCAAGATGTGGTCAACCAAAATGCACAAGCTTTAAACACGCTTGTTAAACAACTTAGCTCCAATTTTGGTGCAATTTCAAGTGTTTTAAATGATATCCTTTCACGTCTTGACAAAGTTGAGGCTGAAGTGCAAATTGATAGGTTGATCACAGGCAGACTTCAAAGTTTGCAGACATATGTGACTCAACAATTAATTAGAGCTGCAGAAATCAGAGCTTCTGCTAATCTTGCTGCTACTAAAATGTCAGAGTGTGTACTTGGACAATCAAAAAGAGTTGATTTTTGTGGAAAGGGCTATCATCTTATGTCCTTCCCTCAGTCAGCACCTCATGGTGTAGTCTTCTTGCATGTGACTTATGTCCCTGCACAAGAAAAGAACTTCACAACTGCTCCTGCCATTTGTCATGATGGAAAAGCACACTTTCCTCGTGAAGGTGTCTTTGTTTCAAATGGCACACACTGGTTTGTAACACAAAGGAATTTTTATGAACCACAAATCATTACTACAGACAACACATTTGTGTCTGGTAACTGTGATGTTGTAATAGGAATTGTCAACAACACAGTTTATGATCCTTTGCAACCTGAATTAGACTCATTCAAGGAGGAGTTAGATAAATATTTTAAGAATCATACATCACCAGATGTTGATTTAGGTGACATCTCTGGCATTAATGCTTCAGTTGTAAACATTCAAAAAGAAATTGACCGCCTCAATGAGGTTGCCAAGAATTTAAATGAATCTCTCATCGATCTCCAAGAACTTGGAAAGTATGAGCAGTATATAAAATGGCCATGGTACATTTGGCTAGGTTTTATAGCTGGCTTGATTGCCATAGTAATGGTGACAATTATGCTTTGCTGTATGACCAGTTGCTGTAGTTGTCTCAAGGGCTGTTGTTCTTGTGGATCCTGCTGCAAATTTGATGAAGACGACTCTGAGCCAGTGCTCAAAGGAGTCAAATTACATTACACATAAACGAACTTATGGATTTGTTTATGAGAATCTTCACAATTGGAACTGTAACTTTGAAGCAAGGTGAAATCAAGGATGCTACTCCTTCAGATTTTGTTCGCGCTACTGCAACGATACCGATACAAGCCTCACTCCCTTTCGGATGGCTTATTGTTGGCGTTGCACTTCTTGCTGTTTTTCAGAGCGCTTCCAAAATCATAACCCTCAAAAAGAGATGGCAACTAGCACTCTCCAAGGGTGTTCACTTTGTTTGCAACTTGCTGTTGTTGTTTGTAACAGTTTACTCACACCTTTTGCTCGTTGCTGCTGGCCTTGAAGCCCCTTTTCTCTATCTTTATGCTTTAGTCTACTTCTTGCAGAGTATAAACTTTGTAAGAATAATAATGAGGCTTTGGCTTTGCTGGAAATGCCGTTCCAAAAACCCATTACTTTATGATGCCAACTATTTTCTTTGCTGGCATACTAATTGTTACGACTATTGTATACCTTACAATAGTGTAACTTCTTCAATTGTCATTACTTCAGGTGATGGCACAACAAGTCCTATTTCTGAACATGACTACCAGATTGGTGGTTATACTGAAAAATGGGAATCTGGAGTAAAAGACTGTGTTGTATTACACAGTTACTTCACTTCAGACTATTACCAGCTGTACTCAACTCAATTGAGTACAGACACTGGTGTTGAACATGTTACCTTCTTCATCTACAATAAAATTGTTGATGAGCCTGAAGAACATGTCCAAATTCACACAATCGACGGTTCATCCGGAGTTGTTAATCCAGTAATGGAACCAATTTATGATGAACCGACGACGACTACTAGCGTGCCTTTGTAAGCACAAGCTGATGAGTACGAACTTATGTACTCATTCGTTTCGGAAGAGACAGGTACGTTAATAGTTAATAGCGTACTTCTTTTTCTTGCTTTCGTGGTATTCTTGCTAGTTACACTAGCCATCCTTACTGCGCTTCGATTGTGTGCGTACTGCTGCAATATTGTTAACGTGAGTCTTGTAAAACCTTCTTTTTACGTTTACTCTCGTGTTAAAAATCTGAATTCTTCTAGAGTTCCTGATCTTCTGGTCTAAACGAACTAAATATTATATTAGTTTTTCTGTTTGGAACTTTAATTTTAGCCATGGCAGATTCCAACGGTACTATTACCGTTGAAGAGCTTAAAAAGCTCCTTGAACAATGGAACCTAGTAATAGGTTTCCTATTCCTTACATGGATTTGTCTTCTACAATTTGCCTATGCCAACAGGAATAGGTTTTTGTATATAATTAAGTTAATTTTCCTCTGGCTGTTATGGCCAGTAACTTTAGCTTGTTTTGTGCTTGCTGCTGTTTACAGAATAAATTGGATCACCGGTGGAATTGCTATCGCAATGGCTTGTCTTGTAGGCTTGATGTGGCTCAGCTACTTCATTGCTTCTTTCAGACTGTTTGCGCGTACGCGTTCCATGTGGTCATTCAATCCAGAAACTAACATTCTTCTCAACGTGCCACTCCATGGCACTATTCTGACCAGACCGCTTCTAGAAAGTGAACTCGTAATCGGAGCTGTGATCCTTCGTGGACATCTTCGTATTGCTGGACACCATCTAGGACGCTGTGACATCAAGGACCTGCCTAAAGAAATCACTGTTGCTACATCACGAACGCTTTCTTATTACAAATTGGGAGCTTCGCAGCGTGTAGCAGGTGACTCAGGTTTTGCTGCATACAGTCGCTACAGGATTGGCAACTATAAATTAAACACAGACCATTCCAGTAGCAGTGACAATATTGCTTTGCTTGTACAGTAAGTGACAACAGATGTTTCATCTCGTTGACTTTCAGGTTACTATAGCAGAGATATTACTAATTATTATGAGGACTTTTAAAGTTTCCATTTGGAATCTTGATTACATCATAAACCTCATAATTAAAAATTTATCTAAGTCACTAACTGAGAATAAATATTCTCAATTAGATGAAGAGCAACCAATGGAGATTGATTAAACGAACATGAAAATTATTCTTTTCTTGGCACTGATAACACTCGCTACTTGTGAGCTTTATCACTACCAAGAGTGTGTTAGAGGTACAACAGTACTTTTAAAAGAACCTTGCTCTTCTGGAACATACGAGGGCAATTCACCATTTCATCCTCTAGCTGATAACAAATTTGCACTGACTTGCTTTAGCACTCAATTTGCTTTTGCTTGTCCTGACGGCGTAAAACACGTCTATCAGTTACGTGCCAGATCAGTTTCACCTAAACTGTTCATCAGACAAGAGGAAGTTCAAGAACTTTACTCTCCAATTTTTCTTATTGTTGCGGCAATAGTGTTTATAACACTTTGCTTCACACTCAAAAGAAAGACAGAATGATTGAACTTTCATTAATTGACTTCTATTTGTGCTTTTTAGCCTTTCTGCTATTCCTTGTTTTAATTATGCTTATTATCTTTTGGTTCTCACTTGAACTGCAAGATCATAATGAAACTTGTCACGCCTAAACGAACATGAAATTTCTTGTTTTCTTAGGAATCATCACAACTGTAGCTGCATTTCACCAAGAATGTAGTTTACAGTCATGTACTCAACATCAACCATATGTAGTTGATGACCCGTGTCCTATTCACTTCTATTCTAAATGGTATATTAGAGTAGGAGCTAGAAAATCAGCACCTTTAATTGAATTGTGCGTGGATGAGGCTGGTTCTAAATCACCCATTCAGTACATCGATATCGGTAATTATACAGTTTCCTGTTTACCTTTTACAATTAATTGCCAGGAACCTAAATTGGGTAGTCTTGTAGTGCGTTGTTCGTTCTATGAAGACTTTTTAGAGTATCATGACGTTCGTGTTGTTTTAGATTTCATCTAAACGAACAAACTAAAATGTCTGATAATGGACCCCAAAATCAGCGAAATGCACCCCGCATTACGTTTGGTGGACCCTCAGATTCAACTGGCAGTAACCAGAATGGAGAACGCAGTGGGGCGCGATCAAAACAACGTCGGCCCCAAGGTTTACCCAATAATACTGCGTCTTGGTTCACCGCTCTCACTCAACATGGCAAGGAAGACCTTAAATTCCCTCGAGGACAAGGCGTTCCAATTAACACCAATAGCAGTCCAGATGACCAAATTGGCTACTACCGAAGAGCTACCAGACGAATTCGTGGTGGTGACGGTAAAATGAAAGATCTCAGTCCAAGATGGTATTTCTACTACCTAGGAACTGGGCCAGAAGCTGGACTTCCCTATGGTGCTAACAAAGACGGCATCATATGGGTTGCAACTGAGGGAGCCTTGAATACACCAAAAGATCACATTGGCACCCGCAATCCTGCTAACAATGCTGCAATCGTGCTACAACTTCCTCAAGGAACAACATTGCCAAAAGGCTTCTACGCAGAAGGGAGCAGAGGCGGCAGTCAAGCCTCTTCTCGTTCCTCATCACGTAGTCGCAACAGTTCAAGAAATTCAACTCCAGGCAGCAGTAGGGGAACTTCTCCTGCTAGAATGGCTGGCAATGGCGGTGATGCTGCTCTTGCTTTGCTGCTGCTTGACAGATTGAACCAGCTTGAGAGCAAAATGTCTGGTAAAGGCCAACAACAACAAGGCCAAACTGTCACTAAGAAATCTGCTGCTGAGGCTTCTAAGAAGCCTCGGCAAAAACGTACTGCCACTAAAGCATACAATGTAACACAAGCTTTCGGCAGACGTGGTCCAGAACAAACCCAAGGAAATTTTGGGGACCAGGAACTAATCAGACAAGGAACTGATTACAAACATTGGCCGCAAATTGCACAATTTGCCCCCAGCGCTTCAGCGTTCTTCGGAATGTCGCGCATTGGCATGGAAGTCACACCTTCGGGAACGTGGTTGACCTACACAGGTGCCATCAAATTGGATGACAAAGATCCAAATTTCAAAGATCAAGTCATTTTGCTGAATAAGCATATTGACGCATACAAAACATTCCCACCAACAGAGCCTAAAAAGGACAAAAAGAAGAAGGCTGATGAAACTCAAGCCTTACCGCAGAGACAGAAGAAACAGCAAACTGTGACTCTTCTTCCTGCTGCAGATTTGGATGATTTCTCCAAACAATTGCAACAATCCATGAGCAGTGCTGACTCAACTCAGGCCTAAACTCATGCAGACCACACAAGGCAGATGGGCTATATAAACGTTTTCGCTTTTCCGTTTACGATATATAGTCTACTCTTGTGCAGAATGAATTCTCGTAACTACATAGCACAAGTAGATGTAGTTAACTTTAATCTCACATAGCAATCTTTAATCAGTGTGTAACATTAGGGAGGACTTGAAAGAGCCACCACATTTTCACCGAGGCCACGCGGAGTACGATCGAGTGTACAGTGAACAATGCTAGGGAGAGCTGCCTATATGGAAGAGCCCTAATGTGTAAAATTAATTTTAGTAGTGCTATCCCCATGTGATTTTAATAGCTTCTTAGGAGAATGACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA";
				
		var data;
		var numLines;	
		var selectedValue
		var chosen_gene = '';
		var chosen_gene_name;
		var output = "";
		var codificated_pos_nucleotide = 0;
		var amino_at_pos_REF = '';
		var protein_pos_I;
		var protein_pos_II;
		var protein_pos_III;	
		var reference_codon;
		var mutated_codon;
		var reference_codon_p;
		var mutated_codon_p;
		var forwardPrimer;
		var probePrimer;
		var reversePrimer;
		var codificated_pos_nucleotide_mutation;
		var mutated_nucleotide = '';
		const BREAK_ = 99;
		const CONTINUE_ = 11;
		var flag_ = 0;
		let positions = [];
		let positionsGen = [];
		let ForwardToReverseSeq = '';
		let forwardCodPos = 0;
		let reverseCodPos = 0;
		let probeCodPos = 0;
		let ForwardToReverseSeqLength = 0;
		
		let chos_gene_nucleotides = [];		
		let codons_positions = [];
		let codon_pos = 0;
		let out2;
		let forwardStart = 0;
		let forwardEnd = 0;
		let probeStart = 0;
		let probeEnd = 0;
		let reverseStart = 0;
		let reverseEnd = 0;
		let frequenceMutationPrimes = 0;
		let frequenceMutation = 0;
		let relFrequenceMutation = 0;
		let synstatus = '';
		let countsyn = 0;
		let frequenceSynMutationPrimes = 0;
		let frequenceNSynMutationPrimes = 0;
		let frequenceSynMutation = 0;
		let frequenceNSynMutation = 0;
		let relFrequenceMutationSyn = 0;
		let relFrequenceMutationNsyn = 0;

		// Separa cada tipo de mutação em um array vazio para ser preenchido depois
		let mutations = {
			'A': [],
			'T': [],
			'C': [],
			'G': []
		};
		let mutations_synstat = {
			'A': [],
			'T': [],
			'C': [],
			'G': []
		};
				
		// Define variables for each gene and extract the nucleotide sequence from "reference"
		var whole_genome = reference.substring(265,29674); // lembrar de mudar no "code" abaixo também
		var nsp1 = reference.substring(265, 805);
		var ORF1ab = reference.substring(265, 21555);
		var nsp2 = reference.substring(805, 2719);
		var nsp3 = reference.substring(2719, 8554);
		var nsp4 = reference.substring(8554, 10054);
		var threeCLikeProteinase = reference.substring(10054, 10972);
		var nsp6 = reference.substring(10972, 11842);
		var nsp7 = reference.substring(11842, 12091);
		var nsp8 = reference.substring(12091, 12685);
		var nsp9 = reference.substring(12685, 13024);
		var nsp10 = reference.substring(13024, 13441);
		var RNAdependentRNAPolymerase = reference.substring(13441, 16236);
		var helicase = reference.substring(16236, 18039);
		var threeToFiveExonuclease = reference.substring(18039, 19620);
		var endoRNAse = reference.substring(19620, 20658);
		var twoORiboseMethyltransferase = reference.substring(20658, 21552);
		var surfaceGlycoprotein = reference.substring(21562, 25384);
		var ORF3aProtein = reference.substring(25392, 26220);
		var envelopeProtein = reference.substring(26244, 26472);
		var membraneGlycoprotein = reference.substring(26522, 27191);
		var ORF6Protein = reference.substring(27201, 27387);
		var ORF7aProtein = reference.substring(27393, 27759);
		var ORF7b = reference.substring(27755, 27887);
		var ORF8Protein = reference.substring(27893, 28259);
		var nucleocapsidPhosphoprotein = reference.substring(28273, 29533);
		var ORF10Protein = reference.substring(29557, 29674);
		
		var code = "var whole_genome = reference.substring(265, 29674);var nsp1 = reference.substring(265, 805);var ORF1ab = reference.substring(265, 21555);var nsp2 = reference.substring(805, 2719);var nsp3 = reference.substring(2719, 8554);var nsp4 = reference.substring(8554, 10054);var threeCLikeProteinase = reference.substring(10054, 10972);var nsp6 = reference.substring(10972, 11842);var nsp7 = reference.substring(11842, 12091);var nsp8 = reference.substring(12091, 12685);var nsp9 = reference.substring(12685, 13024);var nsp10 = reference.substring(13024, 13441);var RNAdependentRNAPolymerase = reference.substring(13441, 16236);var helicase = reference.substring(16236, 18039);var threeToFiveExonuclease = reference.substring(18039, 19620);var endoRNAse = reference.substring(19620, 20658);var twoORiboseMethyltransferase = reference.substring(20658, 21552);var surfaceGlycoprotein = reference.substring(21562, 25384);var ORF3aProtein = reference.substring(25392, 26220);var envelopeProtein = reference.substring(26244, 26472);var membraneGlycoprotein = reference.substring(26522, 27191);var ORF6Protein = reference.substring(27201, 27387);var ORF7aProtein = reference.substring(27393, 27759);var ORF7b = reference.substring(27755, 27887);var ORF8Protein = reference.substring(27893, 28259);var nucleocapsidPhosphoprotein = reference.substring(28273, 29533);var ORF10Protein = reference.substring(29557, 29674);";
		
		// define an object to store the variables and their start/end positions
		var variables = {};

		// define a regular expression to match the variable names and their substring positions
		var regex = /var\s+(\w+)\s+=\s+reference\.substring\((\d+),\s+(\d+)\);/g;

		// loop through all matches of the regular expression in the code
		var match;
		while ((match = regex.exec(code)) !== null) {
		  // extract the variable name, start position, and end position from the match
		  var variable = match[1];
		  var start = parseInt(match[2]);
		  var end = parseInt(match[3]);
		  //console.log('variable',variable,'start',start,'end',end);
		  
		  // add the variable and its start/end positions to the variables object
		  variables[variable] = { start: start, end: end };
		}

		// print the variables object to the console
		////console.log(variables['ORF7b']['start']);
		
		////console.log(ORF7b);
		//const n1 = ORF7b[0];
		//const n2 = ORF7b[1];
		////console.log(n1,n2);
		
		//Dictionary
		const Triples = ["GCT","CGT","GAT","AAT","TGT","GAG","CAG","GGT","CAT","ATT","CTT","AAG","ATG","TTT","CCT","TCT","ACT","TGG","TAT","GTT","TGA","GCG","CGG","GAC","AAC","TGC","GAA","CAA","GGG","CAC","ATC","CTG","AAA","TTC","CCG","TCG","ACG","TAC","GTG","TAG","GCC","CGC","GGC","ATA","CTC","CCC","TCC","ACC","GTC","TAA","GCA","CGA","GGA","CTA","CCA","TCA","ACA","GTA","AGG","TTG","AGT","AGA","TTA","AGC"];
		
		const Aminoacids = ["A","R","D","N","C","E","Q","G","H","I","L","K","M","F","P","S","T","W","Y","V","*","A","R","D","N","C","E","Q","G","H","I","L","K","F","P","S","T","Y","V","*","A","R","G","I","L","P","S","T","V","*","A","R","G","L","P","S","T","V","R","L","S","R","L","S"];
		
		const ToAmino = [Triples, Aminoacids];
		
		////console.log(ToAmino[0][10],ToAmino[1][10]); //ToAmino[0][10] = ToAmino[Triples(0) or Aminoacids(1)][position]
		var protein_p;
		/*var nsp1_p = riBotSome(nsp1,"nsp1");
		var ORF1ab_p = riBotSome(ORF1ab,"ORF1ab");
		var nsp2_p = riBotSome(nsp2,"nsp2");
		var nsp3_p = riBotSome(nsp3,"nsp3");
		var nsp4_p = riBotSome(nsp4,"nsp4");
		var threeCLikeProteinase_p = riBotSome(threeCLikeProteinase,"threeCLikeProteinase");
		var nsp6_p = riBotSome(nsp6,"nsp6");
		var nsp7_p = riBotSome(nsp7,"nsp7");
		var nsp8_p = riBotSome(nsp8,"nsp8");
		var nsp9_p = riBotSome(nsp9,"nsp9");
		var nsp10_p = riBotSome(nsp10,"nsp10");
		var RNAdependentRNAPolymerase_p = riBotSome(RNAdependentRNAPolymerase,"RNAdependentRNAPolymerase");
		var helicase_p = riBotSome(helicase,"helicase");
		var threeToFiveExonuclease_p = riBotSome(threeToFiveExonuclease,"threeToFiveExonuclease");
		var endoRNAse_p = riBotSome(endoRNAse,"endoRNAse");
		var twoORiboseMethyltransferase_p = riBotSome(twoORiboseMethyltransferase,"twoORiboseMethyltransferase");
		var surfaceGlycoprotein_p = riBotSome(surfaceGlycoprotein,"surfaceGlycoprotein");
		var ORF3aProtein_p = riBotSome(ORF3aProtein,"ORF3aProtein");
		var envelopeProtein_p = riBotSome(envelopeProtein,"envelopeProtein");
		var membraneGlycoprotein_p = riBotSome(membraneGlycoprotein,"membraneGlycoprotein");
		var ORF6Protein_p = riBotSome(ORF6Protein,"ORF6Protein");
		var ORF7aProtein_p = riBotSome(ORF7aProtein,"ORF7aProtein");
		var ORF7b_p = riBotSome(ORF7b,"ORF7b");
		var ORF8Protein_p = riBotSome(ORF8Protein,"ORF8Protein");
		var nucleocapsidPhosphoprotein_p = riBotSome(nucleocapsidPhosphoprotein,"nucleocapsidPhosphoprotein");
		var ORF10Protein_p = riBotSome(ORF10Protein,"ORF10Protein");	
		*/
		
		//var ORF10Protein_pos = getPositionVector(ORF10Protein_p,"ORF10Protein");		
		
		//for (var i = 0; i < nsp1.length; i++) {
		  //console.log(nsp1_pos);
		//}	
		
		//Target mutations / target mut

		var search1 = 0;
		var search2 = 0;
		var RelPos = 0;
		var count=0;
		
		var nucleotideBases = {
			'A': 'T',
			'T': 'A',
			'C': 'G',
			'G': 'C',
			'R': 'Y',
			'Y': 'R',
			'a': 'T',
			't': 'A',
			'c': 'G',
			'g': 'C',
			'r': 'y',
			'y': 'r'
		};
					
		readFile();
		
		function main(event) {	
			
			initialize();	
				/*if((initialize() == false)){ 
					//window.alert(`No upload data found: please refresh the page or upload the file`); 
					//return 0;
				}*/

			for (var i = 0; i < numLines; i+=1) {
			
				flag_ = 0;
				flag_ = processingMutationData(i);
				if (flag_ == BREAK_) break;
				if (flag_ == CONTINUE_) continue;
					
				organizeMutations(i);
			}						
			
			//outputFile(output, 'amino_at_pos_REF', 'csv');
			
			writeOutputFilesXLS();
			
		return 0;
		}
		
		function initialize(){
		
			/*let uploadedFile = document.getElementById("upload");
			
			if(uploadedFile.value == ''){
				return false;
			}*/
					
			chooseGene();		
			
			readPrimers();
				  
			protein_p = riBotSome(chosen_gene, selectedValue);			
		  
			for (let k = 0; k < ForwardToReverseSeqLength; k++){
			  mutations['A'][k] = '-';
			  mutations['T'][k] = '-';
			  mutations['C'][k] = '-';
			  mutations['G'][k] = '-';
			}	
		  
			for (let kk = 0; kk < ForwardToReverseSeqLength; kk++){
			  mutations_synstat['A'][kk] = '-';
			  mutations_synstat['T'][kk] = '-';
			  mutations_synstat['C'][kk] = '-';
			  mutations_synstat['G'][kk] = '-';
			}
			
			//console.log("selectedValue = ", selectedValue);
			//console.log("chosen_gene = ", chosen_gene);
			//console.log("protein_p = ", protein_p);
			//output += selectedValue + "," + chosen_gene.length + ",";
			
				let pass = '';
			for (let ii = 0; ii < chosen_gene.length; ii++) {
				chos_gene_nucleotides[ii] = chosen_gene[ii];
					pass += ii+",";
				//console.log(chos_gene_nucleotides);
			}				

			for (let jj = 0; jj < chosen_gene.length; jj++) {
				// Adiciona a posição genômica de cada nucleotídeo na sequência à array "positions"
				if((jj)%3==0&&jj!=0){
					codon_pos = jj/3;		
					codons_positions.push(jj/3);		
					//console.log('RESTO',jj%3,codon_pos,codons_positions);					
				} else {
					codons_positions.push(codon_pos);		
					//console.log('RESTO',jj%3,codon_pos,codons_positions);		
				}
					//console.log('codon_pos',codon_pos,'jj',jj,'codons_positions[jj]',codons_positions[jj]);
					//out2+=`codon_pos, ${codon_pos}, jj, ${jj}, codons_positions[jj], ${codons_positions[jj]} \n`;
			}
			
			//console.log(codons_positions);
		}
		
		function chooseGene(event){					  
		  // Get the select element
			chosen_gene_name = document.getElementById("gene");
			selectedValue = chosen_gene_name.value;
			chosen_gene = window[selectedValue];	
			//console.log('chosen_gene',chosen_gene);
			
			return { selectedValue: selectedValue , chosen_gene: chosen_gene}
			
		}
		
		function readPrimers(){
		
			// Get the input fields by ID
			var forwardInput = document.getElementById("forward");
			var probeInput = document.getElementById("probe");
			var reverseInput = document.getElementById("reverse");

			// Get the values of the input fields
			var forwardValue = forwardInput.value;
			var probeValue = probeInput.value;
			var reverseValue = reverseInput.value;

			// Assign the values to variables
			forwardPrimer = forwardValue;
			probePrimer = probeValue;
			reversePrimer = reverseValue;	
			
			// Processing the reverse primer
			let mappedReversePrimer = "";
			for (let k = 0; k < reversePrimer.length; k++) {
			  mappedReversePrimer = nucleotideBases[reversePrimer.slice(k, k + 1)] + mappedReversePrimer;
			}
			reversePrimer = mappedReversePrimer;
						
			//FALTA INCLUIR R -> A OU G, Y -> T OU C
			
			//console.log("forward=", forwardPrimer);
			//console.log("probePrimer=", probePrimer);
			//console.log("mappedReversePrimer=", reversePrimer);	
			
			
		  // Obtem o tamanho da sequência ForwardToReverseSeq
		  forwardCodPos = searchInSeq_aSeq(chosen_gene, forwardPrimer); //verifique se o primer está alinhado na sequeência correta
		  reverseCodPos = searchInSeq_aSeq(chosen_gene, reversePrimer);
		  probeCodPos = searchInSeq_aSeq(chosen_gene, probePrimer);
		  ForwardToReverseSeqLength = (reverseCodPos + reversePrimer.length) - forwardCodPos;
		  //console.log("forwardCodPos",forwardCodPos,"forwardPrimer",forwardPrimer);
		  //console.log("reverseCodPos",reverseCodPos,"reversePrimer",reversePrimer);
		  //console.log("ForwardToReverseSeqLength", ForwardToReverseSeqLength,"reversePrimer.length",reversePrimer.length);

		  // Obtem a sequência ForwardToReverseSeq
		  ForwardToReverseSeq = chosen_gene.slice(forwardCodPos, (forwardCodPos + ForwardToReverseSeqLength));
		  //console.log("ForwardToReverseSeq", ForwardToReverseSeq);
		  
		  //starts and ends positions
		  
			forwardStart = forwardCodPos + 1;
			forwardEnd = forwardCodPos + forwardPrimer.length;
			probeStart = probeCodPos + 1;
			probeEnd = probeCodPos + probePrimer.length;
			reverseStart = reverseCodPos + 1;
			reverseEnd = reverseCodPos + reversePrimer.length;
			
			if(probePrimer == '') {
			
				probeStart = '';
				probeEnd = '';
			
			}
			
			//console.log('forwardStart',forwardStart,'forwardPrimer.length',forwardPrimer.length,'forwardEnd',forwardEnd);
			//console.log('probeStart',probeStart,'probePrimer.length',probePrimer.length,'probeEnd',probeEnd);
			//console.log('reverseStart',reverseStart,'reversePrimer.length',reversePrimer.length,'reverseEnd',reverseEnd);

		  
		  
		 
		}
		
		function processingMutationData(i){		
			
				let start = variables[selectedValue]['start'];
				
				if (data[i]['Gene_Name'] != selectedValue) return CONTINUE_; //{console.log("1:",data[i]['Gene_Name'] ,"2:",selectedValue) ; return CONTINUE_;}
			
			//output += data[i]['Gene_Name'] + ",";
			//console.log(selectedValue);
			
				const regex1 = /^([A-Za-z*])(\d+)([A-Za-z*])$/;
				
				const match = data[i]['Protein_Mutation'].match(regex1);
				
			//output += data[i]['Protein_Mutation'] + ",";

				if (match) {
					protein_pos_I = match[1];
					protein_pos_II = match[2];
					protein_pos_III = match[3];
					//output += data[i]['Genomic_Position'] + "," + protein_pos_I + "," + protein_pos_II + "," + protein_pos_III + ",";
				  } else {
					window.alert(`Invalid format (ERROR0001): ${data[i]['Protein_Mutation']}`);
					return BREAK_;
				  }
				  
				  codificated_pos_nucleotide = 3*protein_pos_II - 1;
				  //if(codificated_pos_nucleotide > 50 && codificated_pos_nucleotide < 60) console.log("codificated_pos_nucleotide",codificated_pos_nucleotide);
				  //output += (codificated_pos_nucleotide + 1) + ",";
				  //var Protein_pos = getPositionVector(protein_p, selectedValue);	
				  //output += (Protein_pos[codificated_pos_nucleotide]) + ",";	
				  
				  amino_at_pos_REF = protein_p[codificated_pos_nucleotide];
				  //output += amino_at_pos_REF + ",";
				  
					if (protein_pos_I != amino_at_pos_REF){
					 if (protein_pos_III != amino_at_pos_REF){
						window.alert(`Something went wrong (ERROR0002): Please contact the website manager`);
						return BREAK_;
					 } else {
						let temp = protein_pos_I;
						protein_pos_I = protein_pos_III;
						protein_pos_III = temp;							
					 }
					}

					//output += riBotSome('TTA','Triple 1').slice(0,1) + riBotSome('GTA','Triple 2').slice(0,1) + ",";
					
			
				const regex2 = /^([a-zA-Z]{3})\s>\s([a-zA-Z]{3})$/;
				const match2 = data[i]['Mutation'].match(regex2);
				//console.log(match2);
								
				if (match2) {
					reference_codon = match2[1];
					mutated_codon = match2[2];
					//output += data[i]['Mutation'] + "," + reference_codon + "," + mutated_codon + ",";
				  } else {
					window.alert(`Invalid format (ERROR0003): ${data[i]['Mutation']}`);
					return BREAK_;
				}
				
				reference_codon_p = riBotSome(reference_codon,'Triple 1').slice(0,1);
				mutated_codon_p = riBotSome(mutated_codon,'Triple 2').slice(0,1);
				
				
					if (reference_codon_p != protein_pos_I && mutated_codon_p != protein_pos_II){
						if (reference_codon_p != protein_pos_II && mutated_codon_p != protein_pos_I){	
							window.alert(`Something went wrong (ERROR0004): Please contact the website manager`);
							return BREAK_;		
						 } else {
							let temp = reference_codon;
							reference_codon = mutated_codon;
							mutated_codon = temp;								
						 }
					} else if(reference_codon_p==mutated_codon_p){
					
						let codon_of_nucleotide = '';						
						for(let kk = -2; kk < 1; kk++){						
							codon_of_nucleotide += chos_gene_nucleotides[codificated_pos_nucleotide + kk];
							//console.log('codificated_pos_nucleotide',codificated_pos_nucleotide,'codificated_pos_nucleotide + kk',codificated_pos_nucleotide + kk,'chos_gene_nucleotides[codificated_pos_nucleotide + kk]',chos_gene_nucleotides[codificated_pos_nucleotide + kk],'codon_of_nucleotide',codon_of_nucleotide);
						}
						
						//if(i==10016 || i==1699) console.log('ref',codon_of_nucleotide,'seq1',reference_codon,'seq2',mutated_codon);
						
						if(codon_of_nucleotide == reference_codon){
							reference_codon = codon_of_nucleotide;			
						} else if(codon_of_nucleotide == mutated_codon){
							let temp = reference_codon;
							reference_codon = mutated_codon;
							mutated_codon = temp;			
				
							//console.log("search1 (",reference_codon,") = ",search1);
							//console.log("search2 (",mutated_codon,") = ",search2);
						} else if(codon_of_nucleotide != reference_codon){
							if(confirm(`Something went wrong (ERROR0005): Neither of the codons ${reference_codon} and ${mutated_codon} (line ${i} in the input table) correspond with the reference codon ${codon_of_nucleotide} in the genomic position ${data[i]['Genomic_Position']}. Do you want to continue?`)){
								reference_codon = null;
								mutate_codon = null;
								return CONTINUE_;
							} else {
								return BREAK_;
							}
						}
						
						//if(i==10016 || i==1699)  console.log('ref',codon_of_nucleotide,'seq1',reference_codon,'seq2',mutated_codon);
						
					}	

				
					//output += reference_codon_p + "," + mutated_codon_p + ",";
					//output += reference_codon + "," + mutated_codon + "\n";
				
				
				RelPos = 0;
				codificated_pos_nucleotide_mutation = 0;
				if (reference_codon !== mutated_codon) {	
					for (let j = 0; j < 3; j++) {
						if(reference_codon.slice(0,1) != mutated_codon.slice(0,1)) {
							mutated_nucleotide = mutated_codon.slice(0,1);
							RelPos = 1; 
							codificated_pos_nucleotide_mutation = codificated_pos_nucleotide - 1;
							synstatus = data[i]['Syn_Status'] ;
									if(synstatus == 'synonymous'){
										synstatus = 'S';
										frequenceSynMutation++;
									} else if(synstatus == 'non_synonymous'){
										synstatus = 'NS';
										frequenceNSynMutation++;											
									} else {			
										countsynErr++;
										if(countsynErr == 1) window.alert(`ERROR0007: ${synstatus} is not written in accordance with the used terminology. Please rewrite the input table synonymous or non_synonymous mutation information to match either one of two terms: 'synonymous' or 'non_synonymous'. Press OK to continue without synonymous information.`);
										synstatus = 'undefined';
								}
							frequenceMutation++;
							//if(codificated_pos_nucleotide_mutation==53) console.log("RelPos",RelPos,"reference_codon",reference_codon,"mutated_codon",mutated_codon,"mutated_nucleotide",mutated_nucleotide);
							break;
						}
						if(reference_codon.slice(1,2) != mutated_codon.slice(1,2)) {
							mutated_nucleotide = mutated_codon.slice(1,2);
							RelPos = 2; 
							codificated_pos_nucleotide_mutation = codificated_pos_nucleotide;
							synstatus = data[i]['Syn_Status'] ;
									if(synstatus == 'synonymous'){
										synstatus = 'S';	
										frequenceSynMutation++;									
									} else if(synstatus == 'non_synonymous'){
										synstatus = 'NS';	
										frequenceNSynMutation++;										
									} else {			
										countsynErr++;
										if(countsynErr == 1) window.alert(`ERROR0007: ${synstatus} is not written in accordance with the used terminology. Please rewrite the input table synonymous or non_synonymous mutation information to match either one of two terms: 'synonymous' or 'non_synonymous'. Press OK to continue without synonymous information.`);
										synstatus = 'undefined';
								}
							frequenceMutation++;
							//if(codificated_pos_nucleotide_mutation==53) console.log("mutated_codon.slice(0,1)",mutated_codon.slice(0,1),"mutated_codon.slice(1,2)",mutated_codon.slice(1,2),"mutated_codon.slice(2,3)",mutated_codon.slice(2,3));
							//if(codificated_pos_nucleotide_mutation==53) console.log("codificated_pos_nucleotide_mutation",codificated_pos_nucleotide_mutation,"RelPos",RelPos,"reference_codon",reference_codon,"mutated_codon",mutated_codon,"mutated_nucleotide",mutated_nucleotide);
							break;
						}
						if(reference_codon.slice(2,3) != mutated_codon.slice(2,3)) {
							mutated_nucleotide = mutated_codon.slice(2,3);
							RelPos = 3; 
							codificated_pos_nucleotide_mutation = codificated_pos_nucleotide + 1;
							synstatus = data[i]['Syn_Status'] ;
									if(synstatus == 'synonymous'){
										synstatus = 'S';
										frequenceSynMutation++;										
									} else if(synstatus == 'non_synonymous'){
										synstatus = 'NS';
										frequenceNSynMutation++;											
									} else {			
										countsynErr++;
										if(countsynErr == 1) window.alert(`ERROR0007: ${synstatus} is not written in accordance with the used terminology. Please rewrite the input table synonymous or non_synonymous mutation information to match either one of two terms: 'synonymous' or 'non_synonymous'. Press OK to continue without synonymous information.`);
										synstatus = 'undefined';
								}
							frequenceMutation++;
							//if(codificated_pos_nucleotide_mutation==53) console.log("RelPos",RelPos,"reference_codon",reference_codon,"mutated_codon",mutated_codon,"mutated_nucleotide",mutated_nucleotide);
							break;
						}
					}
												
						//console.log("gene=", selectedValue, "reference_codon=",reference_codon,"mutated_codon=",mutated_codon,"RelPos=", RelPos ,"CodPos", codificated_pos_nucleotide_mutation, "GenPos", codificated_pos_nucleotide_mutation+start);	
				}
				
				//console.log(flag_);
			
		return 0;
		}
					
		function organizeMutations(i){
		  
		  //let start = variables[selectedValue]['start']; //gen pos of the start of the chosen gene
		  //let end = variables[selectedValue]['end']; //gen pos of the end of the chosen gene
		  
		  // Obtem a posição genômica de cada elemento da sequência ForwardToReverseSeq
		  positions = [];
		  positionsGen = [];
		  let start_ = variables[selectedValue]['start'];
		  for (let j = 0; j < ForwardToReverseSeqLength; j++) {
			// Adiciona a posição genômica de cada nucleotídeo na sequência à array "positions"
			let codificated_pos_nucleotide_ref = (forwardCodPos + 1) + j;
			let genomic_pos_ref = codificated_pos_nucleotide_ref + start_;
			//console.log('start',start,'variables[selectedValue][start]',variables[selectedValue]['start'],'selectedValue',selectedValue);
			positions.push(codificated_pos_nucleotide_ref);
			positionsGen.push(genomic_pos_ref);
		  }

		  // Separa cada nucleotídeo da sequência ForwardToReverseSeq em um array
		 // let nucleotides = ForwardToReverseSeq.split('');

		  // Itera por cada mutação da linha i e adiciona à array correspondente no objeto mutations
		  for (let j = 0; j < positions.length; j++) {
			//if(codificated_pos_nucleotide_mutation == 53) console.log("positions.length",positions.length,'j',j,"positions[j]",positions[j]);
			if ((positions[j]) == (codificated_pos_nucleotide_mutation)) {
			  //if(codificated_pos_nucleotide_mutation == 53) console.log("=positions[j]=",positions[j],"=codificated_pos_nucleotide_mutation=",codificated_pos_nucleotide_mutation);
			  //if(codificated_pos_nucleotide_mutation == 53) console.log("mutated_nucleotide",mutated_nucleotide);
			  //mutations[mutated_nucleotide].push(mutated_nucleotide);			  
			  mutations[mutated_nucleotide][j] = mutated_nucleotide;	  
			  mutations_synstat[mutated_nucleotide][j] = synstatus;
			  frequenceMutationPrimes ++;

				if(synstatus == 'S'){
					frequenceSynMutationPrimes++;
				} else if(synstatus == 'NS'){
					frequenceNSynMutationPrimes++;											
				}
				
			  //console.log("positions[j]",positions[j],"mutated_nucleotide[positions[j]]",mutated_nucleotide[positions[j]],"mutations[mutated_nucleotide[positions[j]]]",mutations[mutated_nucleotide[positions[j]]],"mutated_nucleotide",mutated_nucleotide);
			  
			} 
		  }		
			
			/*/ Get the textbox element
			const textbox = document.getElementById('textbox');

			// Define the vectors (replace with your own)
			let v1 = mutated_codon;
			let v2= mutated_codon_p
			const vectors = [v1, v2];

			// Calculate the font size based on the textbox size
			const fontSize = Math.floor(textbox.offsetWidth / vectors.reduce((max, vec) => Math.max(max, vec.length), 0));

			// Create a string representation of the vectors
			const vectorsString = vectors.map(vec => vec.join(', ')).join(' ');

			// Set the font size and text content of the textbox
			textbox.style.fontSize = `${fontSize}px`;
			textbox.textContent = vectorsString;*/

		return 0;
		}	

		function writeOutputFilesCSV(){	

		let forwreseq = [];
		  
		relFrequenceMutation = 100* frequenceMutationPrimes / frequenceMutation;
		relFrequenceMutationSyn = 100* frequenceSynMutationPrimes / frequenceSynMutation;
		relFrequenceMutationNsyn = 100* frequenceNSynMutationPrimes / frequenceNSynMutation;
		forwreseq = ForwardToReverseSeq.split('').join(',');
		
		  // Escreve os resultados em um arquivo
		  let output_ = `Genomic Positions:,${positionsGen}\n`
			+ `Codificating Positions:,${positions}\n`
			+ `ForwardToReverseSeq:,${forwreseq}\n`
			+ `Mutations A:,${mutations['A']}\n`
			+ `Mutations T:,${mutations['T']}\n`
			+ `Mutations C:,${mutations['C']}\n`
			+ `Mutations G:,${mutations['G']}\n`
			+ `Mutations A:,${mutations_synstat['A']}\n`
			+ `Mutations T:,${mutations_synstat['T']}\n`
			+ `Mutations C:,${mutations_synstat['C']}\n`
			+ `Mutations G:,${mutations_synstat['G']}\n\n`
			+ `Legend:\n`
			+ `___ S (synonymous)\n`
			+ `___ NS (non_synonymous)\n\n`
			+ `Forward Primer:\n`
			+ `________start: ${forwardStart}\n`
			+ `________end: ${forwardEnd}\n`
			+ `Probe Primer:\n`
			+ `________start: ${probeStart}\n`
			+ `________end: ${probeEnd}\n`
			+ `Reverse Primer:\n`
			+ `________start: ${reverseStart}\n`
			+ `________end: ${reverseEnd}\n\n`
			+ `Frequence of mutation:\n`
			+ `___inter primes: ${frequenceMutationPrimes}\n`
			+ `___into the gene: ${frequenceMutation}\n`
			+ `___relative(%): ${relFrequenceMutation.toFixed(2)}\n`
			+ `Synonymous mutation:\n`
			+ `___inter primes: ${frequenceSynMutationPrimes}\n`
			+ `___into the gene: ${frequenceSynMutation}\n`
			+ `___frelative(%): ${relFrequenceMutationSyn.toFixed(2)}\n`
			+ `Non Synonymous mutation:\n`
			+ `___inter primes: ${frequenceNSynMutationPrimes}\n`
			+ `___into the gene: ${frequenceNSynMutation}\n`
			+ `___frelative(%): ${relFrequenceMutationNsyn.toFixed(2)}\n`;
			
		  let name = 'output_' + selectedValue;//${i}`;
		  let format = 'csv';//'txt';
		  outputFile(output_, name, format);	
		
		}		
		
		/*function getCell(sheet, row, column) {
		  var cellAddress = XLSX.utils.encode_cell({r: row, c: column});
		  return sheet[cellAddress];
		}*/
		
		function writeOutputFilesXLS(){
			try{
				relFrequenceMutation = 100* frequenceMutationPrimes / frequenceMutation;
				relFrequenceMutationSyn = 100* frequenceSynMutationPrimes / frequenceSynMutation;
				relFrequenceMutationNsyn = 100* frequenceNSynMutationPrimes / frequenceNSynMutation;
				const data = [    ['Genomic Positions:', ...positionsGen],
				['Codificating Positions:', ...positions],
				['ForwardToReverseSeq:', ...ForwardToReverseSeq.split('')],
				['Mutations A:', ...mutations['A']],
				['Mutations T:', ...mutations['T']],
				['Mutations C:', ...mutations['C']],
				['Mutations G:', ...mutations['G']],
				['Mutations Syn_Status A:', ...mutations_synstat['A']],
				['Mutations Syn_Status T:', ...mutations_synstat['T']],
				['Mutations Syn_Status C:', ...mutations_synstat['C']],
				['Mutations Syn_Status G:', ...mutations_synstat['G']],
				[''],
				['Legend:'],
				['___ S (synonymous)'],
				['___ NS (non_synonymous)'],
				[''],
				['Forward Primer:'],
				[`________start: ${forwardStart}\n`],
				[`________end: ${forwardEnd}\n`],
				['Probe Primer:'],
				[`________start: ${probeStart}\n`],
				[`________end: ${probeEnd}\n`],
				['Reverse Primer:'],
				[`________start: ${reverseStart}\n`],
				[`________end: ${reverseEnd}\n`],
				[''],
				['Frequence of Mutation:'],
				[`___inter primes: ${frequenceMutationPrimes}`],		
				[`___into the gene: ${frequenceMutation}`],			
				[`___relative(%): ${relFrequenceMutation.toFixed(2)}`],	
				['Synonymous mutation:'],
				[`___inter primes: ${frequenceSynMutationPrimes}`],		
				[`___into the gene: ${frequenceSynMutation}`],			
				[`___frelative(%): ${relFrequenceMutationSyn.toFixed(2)}`],	
				['Non Synonymous mutation:'],
				[`___inter primes: ${frequenceNSynMutationPrimes}`],		
				[`___into the gene: ${frequenceNSynMutation}`],			
				[`___frelative(%): ${relFrequenceMutationNsyn.toFixed(2)}`],					
				];
					
				// Cria um novo workbook
				const workbook = XLSX.utils.book_new();

				// Cria uma nova planilha
				const sheetName = 'Output' + "_" + selectedValue.slice(0,10);
				const worksheet = XLSX.utils.aoa_to_sheet(data);
				//console.log(sheetName);

				// Adiciona a planilha ao workbook
				XLSX.utils.book_append_sheet(workbook, worksheet, sheetName);
				
				// Definir o tamanho das colunas
				worksheet['!cols'] = [
				  { width: 30 }, 
				  ...positionsGen.map(p => ({ width: 6 })) 
				];
				// Converte o workbook para o formato XLS
				const output_ = XLSX.write(workbook, { bookType: 'xls', bookSST: true, type: 'binary'});
				

				// Converte o output para um buffer
				const buffer = new ArrayBuffer(output_.length);
				const view = new Uint8Array(buffer);
				for (let i = 0; i < output_.length; i++) {
				view[i] = output_.charCodeAt(i) & 0xFF;
				}

				// Cria um objeto Blob com o buffer
				const blob = new Blob([buffer], { type: 'application/vnd.ms-excel' });

				// Cria uma URL com o blob
				const url = URL.createObjectURL(blob);

				// Cria um link para download do arquivo
				const link = document.createElement('a');
				link.href = url;
				link.download = sheetName + '.xls';

				// Clica no link para iniciar o download
				document.body.appendChild(link);
				link.click();

				// Remove o link do DOM
				document.body.removeChild(link);
				URL.revokeObjectURL(url);
			} catch (e) {
				writeOutputFilesCSV();
			}
		return 0;
		}
		
		function getFileContentFromUrl(url) {
		  return fetch(url)
			.then(response => {
			  if (!response.ok) {
				throw new Error(`HTTP error! status: ${response.status}`);
			  }
			  return response.text();
			})
			.then(csv => {
			console.log(csv);
			  const data = processData(csv).data;
			  const numLines = processData(csv).numLines;
			  return { data, numLines };
			})
			.catch(error => {
			  console.error(`Error: ${error}`);
            return { data: null, numLines: null };
			});
		}
		
		//console.log(fetch("https://raw.githubusercontent.com/weriskiney/mutations-data/main/mutations_bruto.csv?timestamp=" + new Date().getTime()));
		
		function readFile() {

		let url = "https://raw.githubusercontent.com/weriskiney/mutations-data/main/mutations_bruto.csv?timestamp=" + new Date().getTime(); // Substitua pela URL do seu arquivo
		
		getFileContentFromUrl(url).then(result => {
		  data = result.data;
		  numLines = result.numLines;		  
		});
		}
		
			/*
		
		function readFile() {
			// Get the file object
			var file = event.target.files[0];
			
			// Create a progress bar element
			  var progressBar = document.createElement('progress');
			  progressBar.value = 0;
			  progressBar.max = 100;
			  document.body.appendChild(progressBar);

			// Read the file
			var reader = new FileReader();
			
			reader.onprogress = function(event) {
			if (event.lengthComputable) {
			  var percentLoaded = Math.round((event.loaded / event.total) * 100);
			  progressBar.value = percentLoaded;
				}
			};
  
			reader.onload = function(event) {
				var csv = event.target.result;
				data = processData(csv).data;
				numLines = processData(csv).numLines;	
						//console.log(numLines);
				// Remove the progress bar
				document.body.removeChild(progressBar);
			};
			reader.readAsText(file);
		}*/
			
		function riBotSome(gene,geneName) {
		  let protein = '';
		  var protein_ant = '';
		  //if(geneName == "whole_genome"){ colocar valor "nao codificante (NC)" nas regiões entre os genes, que não podem ser transcritas}
		  if(geneName == "ORF1ab" || geneName == "RNAdependentRNAPolymerase"){
			  for (let i = 0; i < gene.length; i += 1) {
				if(i + (variables[geneName]['start']) >= 13467) {
					if (i + (variables[geneName]['start']) == 13467) {
					
					  const codonA = gene.substring(i - 2, i + 1);
						////console.log("gene=",geneName,"i=",i + (variables[geneName]['start'])," | codonA=",codonA);
					  const codonB = gene.substring(i, i + 3);
						/////console.log("gene=",geneName,"i=",i + (variables[geneName]['start'])," | codonB=",codonB);
					  const aminoIndexA = Triples.indexOf(codonA);
					  const aminoIndexB = Triples.indexOf(codonB);
					  let aminoA = '';
					  let aminoB = '';
					  if (aminoIndexA !== -1) {
						aminoA = Aminoacids[aminoIndexA];
						////console.log("gene=",geneName,"i=",i + (variables[geneName]['start'])," | aminoA=",aminoA);
					  }
					  if (aminoIndexB !== -1) {
						aminoB = Aminoacids[aminoIndexB];
						////console.log("gene=",geneName,"i=",i + (variables[geneName]['start'])," | aminoB=",aminoB);
					  }
					  
						protein += aminoA + "/" + aminoB;
						protein += aminoB + aminoB;		
						//if(gene===RNAdependentRNAPolymerase&&i<34) //console.log("gene=",geneName,"i=", i, "genpos=",i + (variables[geneName]['start'])," | protein(||)=",protein)						
					  
					  protein_ant = aminoB;				
						////console.log("gene=",geneName,"i=",i + (variables[geneName]['start'])," | protein_ant(||)=",protein_ant);
					  i += 2; // pule para o próximo códon depois do códon B
						
					} 
					else {
					  const codon = gene.substring(i, i + 3);
					  //if(gene===RNAdependentRNAPolymerase&&i<34) //console.log("gene=",geneName,"i=",i," | codon=",codon);
					  const aminoIndex = Triples.indexOf(codon);
					  if ((i+1) % 3 === 0) {
						protein += Aminoacids[aminoIndex];
						protein_ant = Aminoacids[aminoIndex];
					//if(gene===RNAdependentRNAPolymerase&&i<34) //console.log("gene=",geneName,"i=",(i)," | protein=",protein);
					  } else {
						protein += protein_ant;
					  }
					}
				//if(gene===RNAdependentRNAPolymerase) //console.log("i=",i," | protein=",protein);
				}
				else {
				  const codon = gene.substring(i, i + 3);
				  const aminoIndex = Triples.indexOf(codon);
				  if (i % 3 === 0) {
					protein += Aminoacids[aminoIndex];
					protein_ant = Aminoacids[aminoIndex];
				//if(gene===RNAdependentRNAPolymerase) //console.log("i=",i," | protein=",protein);
				  } else {
					protein += protein_ant;
				  } 					
				}
			  }
		  }
		  else {
			for (let i = 0; i < gene.length; i += 1) {
				  const codon = gene.substring(i, i + 3);
				  const aminoIndex = Triples.indexOf(codon);
				  if (i % 3 === 0) {
					protein += Aminoacids[aminoIndex];
					protein_ant = Aminoacids[aminoIndex];
				//if(gene===RNAdependentRNAPolymerase) //console.log("i=",i," | protein=",protein);
				  } else {
					protein += protein_ant;
				  } 
			}
		  }		
			//console.log("gene=",geneName," | protein=",protein);		  
		  return protein;
		}
		
		function getPositionVector(sequence,geneName) {
		  let posVector = [];
		  let currentAA = "";
		  let pos = 0;
		  let codon = Array(3).fill("");
		  let codon_current = Array(3).fill("");
		  
		  for (let i = 0; i < sequence.length; i++) {
			if ((i%3) == 0 && ((i + variables[geneName]['start']) < 13467) && (geneName == "ORF1ab" || geneName == "RNAdependentRNAPolymerase")) {
			  pos++;
			}	    
			if (((i-1)%3) == 0 && ((i + variables[geneName]['start']) >= 13467) && (geneName == "ORF1ab" || geneName == "RNAdependentRNAPolymerase")) {
			  pos++;
			}
			if ((i%3) == 0 && (geneName != "ORF1ab") && (geneName != "RNAdependentRNAPolymerase")) {
			  pos++;
			}
			if (sequence[i-1] == "/" ){
			  posVector[i] = pos;
			  posVector[i-2] = posVector[i-2] + "/" + posVector[i];
			  posVector[i+1] = posVector[i];
			  i+=1;
			}
			if (sequence[i] !== "/") {
			  //currentAA = sequence[i];
			  posVector[i] = pos;
			//if (sequence == RNAdependentRNAPolymerase_p&&i >= 21&& i < 61)console.log("i=", i, "sequence[i]=", sequence[i], "posVector=", posVector[i])
			}
		  }
		  //for (let i = 0; i < sequence.length; i++) {
			//if (sequence == ORF10Protein_p)console.log("i=", i, "sequence[i]=", sequence[i], "posVector=", posVector[i])
			//}
		  return posVector;
		}

		function processData(csv) {
		  var lines = csv.split('\n');
		  var data = [];

		  var geneNameMapping = {
			'2\'-O-ribose methyltransferase': 'twoORiboseMethyltransferase',
			'3C-like proteinase': 'threeCLikeProteinase',
			'3\'-to-5\' exonuclease': 'threeToFiveExonuclease',
			'endoRNAse': 'endoRNAse',
			'envelope protein': 'envelopeProtein',
			'helicase': 'helicase',
			'leader protein': 'nsp1',
			'membrane glycoprotein': 'membraneGlycoprotein',
			'nsp1': 'nsp1',
			'nsp10': 'nsp10',
			'nsp2': 'nsp2',
			'nsp3': 'nsp3',
			'nsp4': 'nsp4',
			'nsp6': 'nsp6',
			'nsp7': 'nsp7',
			'nsp8': 'nsp8',
			'nsp9': 'nsp9',
			'nucleocapsid phosphoprotein': 'nucleocapsidPhosphoprotein',
			'ORF10 protein': 'ORF10Protein',
			'ORF3a protein': 'ORF3aProtein',
			'ORF6 protein': 'ORF6Protein',
			'ORF7a protein': 'ORF7aProtein',
			'ORF7b': 'ORF7b',
			'ORF8 protein': 'ORF8Protein',
			'RNA-dependent RNA polymerase': 'RNAdependentRNAPolymerase',
			'surface glycoprotein': 'surfaceGlycoprotein'
		  };

		  // Loop through each line of the CSV
		  for (var i = 0; i < lines.length; i++) {
			var line = lines[i].trim();
			if (line === '') continue; // Skip empty lines

			// Split the line into columns
			var cols = line.split(',');

			// Create a new object for this row of data
			var row = {};
			var geneName = cols.length > 0 ? cols[0] : '';			
					  
			  const mappedName = geneNameMapping[geneName];

			  if (!mappedName) {
			  window.alert(`Unknown gene name: ${geneName}: Please check the spelling of the gene name at the csv file and try again. The program accepts only the names of the genes listed in this page`);
			  }
			
			row['Gene_Name'] = geneNameMapping[geneName] || geneName;
			row['Protein_Mutation'] = cols.length > 1 ? cols[1] : '';
			row['Genomic_Position'] = cols.length > 3 ? cols[3] : '';
			row['Mutation'] = cols.length > 4 ? cols[4] : '';
			row['Syn_Status'] = cols.length > 5 ? cols[5] : '';
			row['Other_Key'] = cols.length > 6 ? cols[6] : ''; // Add new key for other column data

			// Add the row object to the data array
			data.push(row);
		  }

		  return {
			data: data,
			numLines: lines.length
		  };
		}

		function searchInSeq_aCodon(biggerSeq,searchSeq){
		
			var isInSeq = 0;
			var isInSeqPos = 0;
			
			searchSeq = searchSeq.replace(/\s/g, '');
			//if(k%20==0) console.log("k=",k);
			//if(k%20==0) console.log("biggerSeq=",biggerSeq);
			//if(k%20==0) console.log("biggerSeq.length - 3=",biggerSeq.length - 3);
			//if(k%20==0) console.log("searchSeq=",searchSeq);

			for (let i = 0; i <= biggerSeq.length - 3; i++) {
				//if(searchSeq == 'CCC'   && i==0) console.log("i=",i);
				//if(searchSeq == 'CCC'   && i==0) console.log("biggerSeq=",biggerSeq);
				//if(searchSeq == 'CCC'   && i==0) console.log("searchSeq[0]=",searchSeq[0]);
			  if (biggerSeq[i] === searchSeq[0]) {
				//if(searchSeq == 'CCC'   && i==0) console.log("biggerSeq[i+1]=",biggerSeq[i+1]);
				//if(searchSeq == 'CCC'   && i==0) console.log("searchSeq[1]=",searchSeq[1]);
				//if(searchSeq == 'CCC'   && i==0) console.log("biggerSeq[i+2]=",biggerSeq[i+2]);
				//if(searchSeq == 'CCC'   && i==0) console.log("searchSeq[2]=",searchSeq[2]);
				//if(searchSeq == 'CCC'   && i==0) console.log(`\n`);
				if (biggerSeq[i+1] === searchSeq[1] && biggerSeq[i+2] === searchSeq[2]) {
				  isInSeq = 1;
				  isInSeqPos = i;
				}
			  }
			}
		return {isInSeq: isInSeq, isInSeqPos: isInSeqPos};
		}

		function searchInSeq_aSeq_old(biggerSeq_, searchSeq_) {
		  let isInSeq_ = 0;
		  let InSeqPos_ = -1;
		  let i = 0
		  
		  searchSeq_ = searchSeq_.replace(/\s/g, '');
		  var searchForwardToReverseSeqLength = searchSeq_.length;

		  for (i = 0; i <= (biggerSeq_.length - searchForwardToReverseSeqLength); i++) {
			if (biggerSeq_.substring(i, i + searchForwardToReverseSeqLength) === searchSeq_) {
			  isInSeq_ = 1;
			  InSeqPos_ = i;			  
			  break;
			}	    
		  }
		  
			if (InSeqPos_ == -1){
			  window.alert(`ERROR0006: ${searchSeq_} not found. Please contact the site manager`);
			  return BREAK_;
			}		

		  return InSeqPos_;
		}
		
		function searchInSeq_aSeq(biggerSeq_, searchSeq_) {
		  const nucleotideMap = {
			A: ["A"],
			C: ["C"],
			G: ["G"],
			T: ["T"],
			R: ["A", "G"],
			Y: ["T", "C"]
		  };

		  let isInSeq_ = 0;
		  let InSeqPos_ = -1;
		  let i = 0;

		  // Remove whitespaces from searchSeq_
		  searchSeq_ = searchSeq_.replace(/\s/g, "");

		  // Get the length of the search sequence, ignoring fake nucleotides
		  const searchForwardToReverseSeqLength = [...searchSeq_].filter(nucleotide => nucleotideMap[nucleotide]).length;

		  for (i = 0; i <= (biggerSeq_.length - searchForwardToReverseSeqLength); i++) {
			let matchFound = true;
			for (let j = 0; j < searchSeq_.length; j++) {
			  const searchNucleotide = searchSeq_[j];
			  const biggerNucleotide = biggerSeq_[i + j];
			  if (!nucleotideMap[searchNucleotide] || !nucleotideMap[searchNucleotide].includes(biggerNucleotide)) {
				matchFound = false;
				break;
			  }
			}
			if (matchFound) {
			  isInSeq_ = 1;
			  InSeqPos_ = i;
			  break;
			}
		  }

		  if (InSeqPos_ == -1) {
			window.alert(`ERROR0006: ${searchSeq_} not found. Please contact the site manager`);
			return BREAK_;
		  }

		  return InSeqPos_;
		}


		function outputFile(output, name, format) {
		
		var format_ = format;
		// Write the data to a file
		// Create a Blob object
			var blob = new Blob([output], {type: 'text/'+ format_ + ';charset=utf-8;'});

		// Create a temporary anchor element
			var link = document.createElement("a");
			link.href = URL.createObjectURL(blob);
			link.download = name + "." + format_;
			link.style.display = "none";
			document.body.appendChild(link);

		// Click the link to download the file
			link.click();

		// Clean up the temporary anchor element
			document.body.removeChild(link);
		
		}
		
	</script>
	
</body>
</html>
